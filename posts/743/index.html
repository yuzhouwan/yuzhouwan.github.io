<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/yuzhouwan_logo_with_copyright.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/yuzhouwan_logo_32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/yuzhouwan_logo_16x16.ico">
  <link rel="mask-icon" href="/yuzhouwan_logo_with_copyright.jpg" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yuzhouwan.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":5,"onmobile":true},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":true,"nav":{"valine":{"text":"Valine：匿名","order":-1},"disqus":{"text":"Disqus：海外","order":-2},"gitalk":{"text":"Gitalk：可用 Github 账号登录","order":-3}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Apache Superset 是什么？ Apache Superset™ is a modern data exploration and visualization platform.  基础组件Flask　Python 几大著名 Web 框架之一，以其轻量级，高可扩展性而著名  Jinja2  模板引擎  Werkzeug  WSGI 工具集   Gunicorn　Gunicorn 是一个开">
<meta property="og:type" content="article">
<meta property="og:title" content="Apache Superset 二次开发">
<meta property="og:url" content="https://yuzhouwan.com/posts/743/">
<meta property="og:site_name" content="宇宙湾">
<meta property="og:description" content="Apache Superset 是什么？ Apache Superset™ is a modern data exploration and visualization platform.  基础组件Flask　Python 几大著名 Web 框架之一，以其轻量级，高可扩展性而著名  Jinja2  模板引擎  Werkzeug  WSGI 工具集   Gunicorn　Gunicorn 是一个开">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://yuzhouwan.com/picture/superset/apache_superset_login.png">
<meta property="og:image" content="https://yuzhouwan.com/picture/superset/apache_superset_dashboards.png">
<meta property="og:image" content="https://img.shields.io/badge/QQ%E7%BE%A4-1020982-blue.svg">
<meta property="og:image" content="https://img.shields.io/badge/QQ%E7%BE%A4-1217710-blue.svg">
<meta property="og:image" content="https://img.shields.io/badge/QQ%E7%BE%A4-1670647-blue.svg">
<meta property="og:image" content="https://img.shields.io/badge/QQ%E7%BE%A4-5366753-blue.svg">
<meta property="article:published_time" content="2017-04-03T12:59:57.000Z">
<meta property="article:modified_time" content="2021-05-18T08:45:34.180Z">
<meta property="article:author" content="Benedict Jin">
<meta property="article:tag" content="Apache Druid">
<meta property="article:tag" content="Apache Superset">
<meta property="article:tag" content="Python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://yuzhouwan.com/picture/superset/apache_superset_login.png">

<link rel="canonical" href="https://yuzhouwan.com/posts/743/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Apache Superset 二次开发 | 宇宙湾</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-97020848-1"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-97020848-1');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>


<style>.null { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .null > span { position: relative; z-index: 10; }  .null img, .null .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .null img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .null-fallback { color: inherit; } .null-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="宇宙湾" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">宇宙湾</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">厚积薄发</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">161</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">16</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">55</span></a>

  </li>
        <li class="menu-item menu-item-书单">

    <a href="/books/" rel="section"><i class="fa fa-book fa-fw"></i>书单</a>

  </li>
        <li class="menu-item menu-item-影视">

    <a href="/movies/" rel="section"><i class="fa fa-film fa-fw"></i>影视</a>

  </li>
        <li class="menu-item menu-item-友链">

    <a href="/links/" rel="section"><i class="fa fa-link fa-fw"></i>友链</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://yuzhouwan.com/posts/743/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/yuzhouwan_logo_128x128.ico">
      <meta itemprop="name" content="Benedict Jin">
      <meta itemprop="description" content="Benedict Jin's Blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="宇宙湾">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Apache Superset 二次开发
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2017-04-03 20:59:57" itemprop="dateCreated datePublished" datetime="2017-04-03T20:59:57+08:00">2017-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-18 16:45:34" itemprop="dateModified" datetime="2021-05-18T16:45:34+08:00">2021-05-18</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">大数据</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>43k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>39 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="Apache-Superset-是什么？"><a href="#Apache-Superset-是什么？" class="headerlink" title="Apache Superset 是什么？"></a>Apache Superset 是什么？</h2><blockquote>
<p><strong><a target="_blank" rel="external nofollow noopener noreferrer" href="https://superset.apache.org/">Apache Superset</a></strong>™ is a modern data exploration and visualization platform.</p>
</blockquote>
<h2 id="基础组件"><a href="#基础组件" class="headerlink" title="基础组件"></a>基础组件</h2><h3 id="Flask"><a href="#Flask" class="headerlink" title="Flask"></a>Flask</h3><p>　<a href="https://yuzhouwan.com/posts/43687/">Python</a> 几大著名 Web 框架之一，以其轻量级，高可扩展性而著名</p>
<ul>
<li><p>Jinja2<br>  模板引擎</p>
</li>
<li><p>Werkzeug<br>  WSGI 工具集</p>
</li>
</ul>
<h3 id="Gunicorn"><a href="#Gunicorn" class="headerlink" title="Gunicorn"></a>Gunicorn</h3><p>　Gunicorn 是一个开源的 Python WSGI HTTP 服务器，移植于 Ruby 的 Unicorn 项目的采用 pre-fork 模式的服务器</p>
<h4 id="WSGI"><a href="#WSGI" class="headerlink" title="WSGI"></a>WSGI</h4><p>　WSGI，即 Python <strong>W</strong>eb <strong>S</strong>erver <strong>G</strong>ateway <strong>I</strong>nterface，是专门用于 Python 应用程序或框架与 Web 服务器之间的一种接口，没有官方的实现，因为 WSGI 更像一个协议，只要遵照这些协议，WSGI 应用都可以在 任何服务器上运行，反之亦然</p>
<h4 id="Pre-Fork"><a href="#Pre-Fork" class="headerlink" title="Pre-Fork"></a>Pre-Fork</h4><p>　一个进程处理一个请求，基于 select 模型，所以最多一次创建 1024 个进程<br>　预先创建进程，pre-fork 采用的是预派生子进程方式，用子进程处理不同的请求，每个请求对应一个子进程，进程之间是彼此独立的<br>　一定程度上加快了进程的响应速度</p>
<span id="more"></span>
<h3 id="Django"><a href="#Django" class="headerlink" title="Django"></a>Django</h3><p>　Django 是一个开放源代码的 Web 应用框架，由 Python 写成。采用了 MVC 的软件设计模式，使得开发复杂的、数据库驱动的网站变得简单<br>　Django 注重组件的重用性和”可插拔性”，敏捷开发和 DRY 法则（Do not Repeat Yourself）</p>
<p>　核心组件</p>
<ul>
<li>物件导向的映射器，用作数据模型（以 Python 类的形式定义）和 关联性数据库间的媒介</li>
<li>基于正则表达式的 URL 分发器</li>
<li>视图系统，用于处理请求</li>
<li>模板系统</li>
</ul>
<h3 id="PyDruid"><a href="#PyDruid" class="headerlink" title="PyDruid"></a>PyDruid</h3><p>　A Python connector for Druid<br>　Exposes a simple API to create, execute, and analyze Druid queries</p>
<h3 id="Pandas"><a href="#Pandas" class="headerlink" title="Pandas"></a>Pandas</h3><p>　Pandas is a Python package providing fast, flexible, and expressive data structures designed to make working with “relational” or “labeled” data both easy and intuitive</p>
<h3 id="SciPy"><a href="#SciPy" class="headerlink" title="SciPy"></a>SciPy</h3><p>　SciPy 是基于 Numpy 构建的一个集成了多种数学算法和方便的函数的 Python 模块</p>
<h3 id="Scikit-learn"><a href="#Scikit-learn" class="headerlink" title="Scikit-learn"></a>Scikit-learn</h3><p>　Machine Learning in Python</p>
<h3 id="D3-js"><a href="#D3-js" class="headerlink" title="D3.js"></a>D3.js</h3><p>　<a target="_blank" rel="external nofollow noopener noreferrer" href="https://d3js.org/">D3.js</a> 是一个操纵数据的 JavaScript 库</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="基础环境"><a href="#基础环境" class="headerlink" title="基础环境"></a>基础环境</h3><h4 id="OS"><a href="#OS" class="headerlink" title="OS"></a>OS</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ uname -a</span><br><span class="line">Linux 2.6.32-431.el6.x86_64 <span class="comment">#1 SMP Fri Nov 22 03:15:09 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux</span></span><br><span class="line"></span><br><span class="line">$ cat /proc/version</span><br><span class="line">Linux version 2.6.32-431.el6.x86_64 (mockbuild@c6b8.bsys.dev.centos.org) (gcc version 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC) ) <span class="comment">#1 SMP Fri Nov 22 03:15:09 UTC 2013</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># For Fedora and RHEL-derivatives</span></span><br><span class="line"><span class="comment"># [Doc]: Other System https://superset.apache.org/installation.html#os-dependencies</span></span><br><span class="line">$ sudo yum upgrade python-setuptools -y</span><br><span class="line">$ sudo yum install gcc libffi-devel python-devel python-pip python-wheel openssl-devel libsasl2-devel openldap-devel -y</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Machines"><a href="#Machines" class="headerlink" title="Machines"></a>Machines</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 外网（http://192.168.1.10:9097/）</span></span><br><span class="line">superset01		               192.168.1.10           Superset</span><br><span class="line">druid01		        	       192.168.1.11           Druid</span><br><span class="line">druid02		        	       192.168.1.12           MySQL</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster 配置</span></span><br><span class="line">Cluster                         druid cluster</span><br><span class="line">Coordinator Host                192.168.1.11</span><br><span class="line">Coordinator Port                8081</span><br><span class="line">Coordinator Endpoint            druid/coordinator/v1/metadata</span><br><span class="line">Broker Host                     192.168.1.13</span><br><span class="line">Broker Port                     8082</span><br><span class="line">Broker Endpoint                 druid/v2</span><br><span class="line">Cache Timeout                   86400				<span class="comment"># 1day: result_backend</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 线上（http://192.168.2.10:9097）</span></span><br><span class="line">druid-prd01	                    192.168.2.10         Superset</span><br><span class="line">druid-prd02	                    192.168.2.11         Druid</span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster 配置</span></span><br><span class="line">Cluster                         druid cluster</span><br><span class="line">Coordinator Host                192.168.2.11</span><br><span class="line">Coordinator Port                8081</span><br><span class="line">Coordinator Endpoint            druid/coordinator/v1/metadata</span><br><span class="line">Broker Host                     192.168.2.13</span><br><span class="line">Broker Port                     8082</span><br><span class="line">Broker Endpoint                 druid/v2</span><br><span class="line">Cache Timeout                   86400                 <span class="comment"># 1day: result_backend</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="Python-相关"><a href="#Python-相关" class="headerlink" title="Python 相关"></a>Python 相关</h3><h4 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">$ python --version</span><br><span class="line">  Python 2.7.8</span><br><span class="line"></span><br><span class="line">[Note]: Superset is tested using Python 2.7 and Python 3.4+. Python 3 is the recommended version, Python 2.6 won<span class="string">'t be supported.'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 升级 Python（stable: Python 2.7.12 | 3.4.5, lastest: Python 3.5.2 [2016/12/15]）</span></span><br><span class="line">https://www.python.org/downloads/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 python ftp 服务器中下载到，对应版本的 python</span></span><br><span class="line">$ wget http://python.org/ftp/python/2.7.12/Python-2.7.12.tgz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 编译</span></span><br><span class="line">$ tar -zxvf Python-2.7.12.tgz</span><br><span class="line">$ <span class="built_in">cd</span> /root/software/Python-2.7.12</span><br><span class="line">$ ./configure --prefix=/usr/<span class="built_in">local</span>/python27</span><br><span class="line">$ make</span><br><span class="line">$ make install</span><br><span class="line"></span><br><span class="line">$ ls /usr/<span class="built_in">local</span>/python27/ -al</span><br><span class="line"></span><br><span class="line">  drwxr-xr-x.  6 root root 4096 12月 15 14:22 .</span><br><span class="line">  drwxr-xr-x. 13 root root 4096 12月 15 14:20 ..</span><br><span class="line">  drwxr-xr-x.  2 root root 4096 12月 15 14:22 bin</span><br><span class="line">  drwxr-xr-x.  3 root root 4096 12月 15 14:21 include</span><br><span class="line">  drwxr-xr-x.  4 root root 4096 12月 15 14:22 lib</span><br><span class="line">  drwxr-xr-x.  3 root root 4096 12月 15 14:22 share</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 覆盖原来的 python6</span></span><br><span class="line">$ <span class="built_in">which</span> python</span><br><span class="line">  /usr/<span class="built_in">local</span>/bin/python</span><br><span class="line"><span class="comment"># mv /usr/bin/python /usr/bin/python_old</span></span><br><span class="line">$ mv /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/python_old</span><br><span class="line">$ ln -s /usr/<span class="built_in">local</span>/python27/bin/python /usr/<span class="built_in">local</span>/bin/</span><br><span class="line">$ python --version</span><br><span class="line">  Python 2.7.12</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 yum 引用的 python 版本为旧版 2.6 的 python</span></span><br><span class="line">$ vim /usr/bin/yum</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 第一行修改为 python2.6</span></span><br><span class="line">  <span class="comment">#!/usr/bin/python2.6</span></span><br><span class="line"></span><br><span class="line">$ yum --version | sed <span class="string">'2,$d'</span></span><br><span class="line">  3.2.29</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Pip"><a href="#Pip" class="headerlink" title="Pip"></a>Pip</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ pip --version</span><br><span class="line">$ pip 9.0.1 from /usr/<span class="built_in">local</span>/lib/python2.7/site-packages (python 2.7)</span><br><span class="line"></span><br><span class="line"><span class="comment"># upgrade setup tools and pip</span></span><br><span class="line">$ pip install --upgrade setuptools pip</span><br><span class="line"></span><br><span class="line"><span class="comment">## Offline 环境下安装 pip</span></span><br><span class="line"><span class="comment"># https://pypi.python.org/pypi/setuptools#code-of-conduct 下载 setuptools-32.0.0.tar.gz</span></span><br><span class="line">$ tar zxvf setuptools-32.0.0.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> setuptools-32.0.0</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> setuptools-32.0.0</span><br><span class="line">$ python setup.py install</span><br><span class="line"></span><br><span class="line"><span class="comment"># https://pypi.python.org/pypi/pip 下载 pip-9.0.1.tar.gz</span></span><br><span class="line">$ wget --no-check-certificate https://pypi.python.org/packages/11/b6/abcb525026a4be042b486df43905d6893fb04f05aac21c32c638e939e447/pip-9.0.1.tar.gz<span class="comment">#md5=35f01da33009719497f01a4ba69d63c9</span></span><br><span class="line">$ tar zxvf pip-9.0.1.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> pip-9.0.1</span><br><span class="line">$ python setup.py install</span><br><span class="line">  Installed /usr/<span class="built_in">local</span>/python27/lib/python2.7/site-packages/pip-9.0.1-py2.7.egg</span><br><span class="line">  Processing dependencies <span class="keyword">for</span> pip==9.0.1</span><br><span class="line">  Finished processing dependencies <span class="keyword">for</span> pip==9.0.1</span><br><span class="line"></span><br><span class="line">$ pip --version</span><br><span class="line">  pip 9.0.1 from /root/software/pip-9.0.1 (python 2.7)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Virtualenv"><a href="#Virtualenv" class="headerlink" title="Virtualenv"></a>Virtualenv</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ pip install virtualenv</span><br><span class="line"></span><br><span class="line"><span class="comment"># virtualenv is shipped in Python 3 as pyvenv</span></span><br><span class="line">$ virtualenv venv</span><br><span class="line">$ <span class="built_in">source</span> venv/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment">## Offline 环境下安装 virtualenv</span></span><br><span class="line"><span class="comment"># https://pypi.python.org/pypi/virtualenv#downloads 下载 virtualenv-15.1.0.tar.gz</span></span><br><span class="line">$ tar zxvf virtualenv-15.1.0.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> virtualenv-15.1.0</span><br><span class="line">$ python setup.py install</span><br><span class="line"></span><br><span class="line">$ virtualenv --version</span><br><span class="line">  15.1.0</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Superset-相关"><a href="#Superset-相关" class="headerlink" title="Superset 相关"></a>Superset 相关</h3><h4 id="Superset-初始化"><a href="#Superset-初始化" class="headerlink" title="Superset 初始化"></a>Superset <a target="_blank" rel="external nofollow noopener noreferrer" href="https://superset.incubator.apache.org/installation.html#making-your-own-build">初始化</a></h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">$ pip install superset</span><br><span class="line"></span><br><span class="line"><span class="comment">## Offline 环境下安装 superset</span></span><br><span class="line"><span class="comment"># https://pypi.python.org/pypi/superset 下载 superset-0.15.0.tar.gz</span></span><br><span class="line">$ tar zxvf superset-0.15.0.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> superset-0.15.0</span><br><span class="line">$ python setup.py install</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an admin user</span></span><br><span class="line">$ fabmanager create-admin --app superset</span><br><span class="line"></span><br><span class="line">  Username [admin]:        <span class="comment"># login name</span></span><br><span class="line">  User first name [admin]: <span class="comment"># first name</span></span><br><span class="line">  User last name [user]:   <span class="comment"># lastname</span></span><br><span class="line">  Email [admin@fab.org]:   <span class="comment"># email, must unique</span></span><br><span class="line">  Password: </span><br><span class="line">  Repeat <span class="keyword">for</span> confirmation: </span><br><span class="line">  Error: the two entered values <span class="keyword">do</span> not match</span><br><span class="line">  Password:			 	<span class="comment">#superset</span></span><br><span class="line">  Repeat <span class="keyword">for</span> confirmation: <span class="comment">#superset</span></span><br><span class="line">  // ...</span><br><span class="line">  Recognized Database Authentications.</span><br><span class="line">  2016-12-14 17:53:40,945:INFO:flask_appbuilder.security.sqla.manager:Added user superset db upgrade</span><br><span class="line">  Admin User superset db upgrade created.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initialize the database</span></span><br><span class="line">$ superset db upgrade</span><br><span class="line"></span><br><span class="line">  // ...</span><br><span class="line">  INFO  [alembic.runtime.migration] Context impl SQLiteImpl.</span><br><span class="line">  INFO  [alembic.runtime.migration] Will assume transactional DDL.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Load some data to play with</span></span><br><span class="line">$ superset load_examples</span><br><span class="line"></span><br><span class="line">  Loading examples into &lt;SQLA engine=u<span class="string">'sqlite:////root/.superset/superset.db'</span>&gt;</span><br><span class="line">  Creating default CSS templates</span><br><span class="line">  Loading energy related dataset</span><br><span class="line">  Creating table [wb_health_population] reference</span><br><span class="line">  2016-12-14 17:58:09,568:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:58:09,575:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Loading [World Bank<span class="string">'s Health Nutrition and Population Stats]'</span></span><br><span class="line">  Creating table [wb_health_population] reference</span><br><span class="line">  2016-12-14 17:58:30,840:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:58:30,846:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create default roles and permissions</span></span><br><span class="line">$ superset init</span><br><span class="line"></span><br><span class="line">  Loading examples into &lt;SQLA engine=u<span class="string">'sqlite:////root/.superset/superset.db'</span>&gt;</span><br><span class="line">  Creating default CSS templates</span><br><span class="line">  Loading energy related dataset</span><br><span class="line">  Creating table [wb_health_population] reference</span><br><span class="line">  2016-12-14 17:58:09,568:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:58:09,575:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Loading [World Bank<span class="string">'s Health Nutrition and Population Stats]</span></span><br><span class="line"><span class="string">  Creating table [wb_health_population] reference</span></span><br><span class="line"><span class="string">  2016-12-14 17:58:30,840:INFO:root:Creating database reference</span></span><br><span class="line"><span class="string">  2016-12-14 17:58:30,846:INFO:root:sqlite:////root/.superset/superset.db</span></span><br><span class="line"><span class="string">  Creating slices</span></span><br><span class="line"><span class="string">  Creating a World'</span>s Health Bank dashboard</span><br><span class="line">  Loading [Birth names]</span><br><span class="line">  Done loading table!</span><br><span class="line">  --------------------------------------------------------------------------------</span><br><span class="line">  Creating table [birth_names] reference</span><br><span class="line">  2016-12-14 17:58:52,276:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:58:52,280:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Creating some slices</span><br><span class="line">  Creating a dashboard</span><br><span class="line">  Loading [Random time series data]</span><br><span class="line">  Done loading table!</span><br><span class="line">  --------------------------------------------------------------------------------</span><br><span class="line">  Creating table [random_time_series] reference</span><br><span class="line">  2016-12-14 17:58:53,953:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:58:53,957:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Creating a slice</span><br><span class="line">  Loading [Random long/lat data]</span><br><span class="line">  Done loading table!</span><br><span class="line">  --------------------------------------------------------------------------------</span><br><span class="line">  Creating table reference</span><br><span class="line">  2016-12-14 17:59:09,732:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:59:09,736:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Creating a slice</span><br><span class="line">  Loading [Multiformat time series]</span><br><span class="line">  Done loading table!</span><br><span class="line">  --------------------------------------------------------------------------------</span><br><span class="line">  Creating table [multiformat_time_series] reference</span><br><span class="line">  2016-12-14 17:59:10,421:INFO:root:Creating database reference</span><br><span class="line">  2016-12-14 17:59:10,426:INFO:root:sqlite:////root/.superset/superset.db</span><br><span class="line">  Creating some slices</span><br><span class="line">  Loading [Misc Charts] dashboard</span><br><span class="line">  Creating the dashboard</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Start the web server on port 8088</span></span><br><span class="line">$ superset runserver -p 8088</span><br><span class="line"></span><br><span class="line"><span class="comment"># To start a development web server, use the -d switch</span></span><br><span class="line"><span class="comment"># superset runserver -d</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Refresh Druid Datasource (after config it)</span></span><br><span class="line">$ superset refresh_druid</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Virtualenv-工作空间"><a href="#Virtualenv-工作空间" class="headerlink" title="Virtualenv 工作空间"></a>Virtualenv 工作空间</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># superset01 192.168.1.10</span></span><br><span class="line">$ <span class="built_in">cd</span> root</span><br><span class="line">$ virtualenv -p /usr/<span class="built_in">local</span>/bin/python --system-site-packages --always-copy superset</span><br><span class="line">$ <span class="built_in">source</span> superset/bin/activate</span><br><span class="line"></span><br><span class="line"><span class="comment"># 详见下文 `遇到的坑` - `安装 superset 需要下载依赖库` 部分</span></span><br><span class="line"><span class="comment"># 旧版</span></span><br><span class="line"><span class="comment"># pip install --download package -r requirements.txt</span></span><br><span class="line"><span class="comment"># 新版 (v19.0.3)</span></span><br><span class="line"><span class="comment"># pip download -d package -r requirements.txt</span></span><br><span class="line">$ pip install -r /root/requirements.txt</span><br><span class="line"></span><br><span class="line">$ superset runserver -a 0.0.0.0 -p 8088</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建议使用 rsync，详见 `部署上线` 部分</span></span><br><span class="line">$ <span class="built_in">cd</span> /root</span><br><span class="line">$ tar zcvf virtualenv.tar.gz virtualenv/</span><br><span class="line">$ scp virtualenv.tar.gz root@192.168.1.13:/root/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 192.168.1.13</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/virtualenv/superset</span><br><span class="line">$ <span class="built_in">source</span> bin/activate</span><br></pre></td></tr></tbody></table></figure>
<h4 id="VirtualenvWrapper"><a href="#VirtualenvWrapper" class="headerlink" title="VirtualenvWrapper"></a>VirtualenvWrapper</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 【拓展】</span></span><br><span class="line"><span class="comment"># virtualenvwrapper 是 virtualenv 的扩展工具，可以方便的创建、删除、复制、切换不同的虚拟环境</span></span><br><span class="line">$ pip install virtualenvwrapper</span><br><span class="line">$ mkdir ~/workspaces</span><br><span class="line">$ vim ~/.bashrc</span><br><span class="line">  <span class="comment"># 增加</span></span><br><span class="line">  <span class="built_in">export</span> WORKON_HOME=~/virtualenv</span><br><span class="line">  <span class="built_in">source</span> /usr/<span class="built_in">local</span>/bin/virtualenvwrapper.sh</span><br><span class="line"></span><br><span class="line">$ mkvirtualenv --python=/usr/bin/python superset</span><br><span class="line">  Running virtualenv with interpreter /usr/bin/python</span><br><span class="line">  New python executable <span class="keyword">in</span> /root/virtualenv/superset/bin/python</span><br><span class="line">  Installing setuptools, pip, wheel...done.</span><br><span class="line">  virtualenvwrapper.user_scripts creating /root/virtualenv/superset/bin/predeactivate</span><br><span class="line">  virtualenvwrapper.user_scripts creating /root/virtualenv/superset/bin/postdeactivate</span><br><span class="line">  virtualenvwrapper.user_scripts creating /root/virtualenv/superset/bin/preactivate</span><br><span class="line">  virtualenvwrapper.user_scripts creating /root/virtualenv/superset/bin/postactivate</span><br><span class="line">  virtualenvwrapper.user_scripts creating /root/virtualenv/superset/bin/get_env_details</span><br><span class="line">(superset) [root@superset01 virtualenv]<span class="comment"># </span></span><br><span class="line">(superset) [root@superset01 virtualenv]<span class="comment"># deactivate</span></span><br><span class="line"></span><br><span class="line">$ workon superset</span><br><span class="line">(superset) [root@superset01 virtualenv]<span class="comment"># lsvirtualenv -b</span></span><br><span class="line">superset</span><br></pre></td></tr></tbody></table></figure>
<h3 id="部署上线"><a href="#部署上线" class="headerlink" title="部署上线"></a>部署上线</h3><h4 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rsync 替换 scp 可以确保软链接 也能被 cp</span></span><br><span class="line">$ rsync -avuz -e ssh /home/superset/superset-0.15.4/ yuzhouwan@middle:/home/yuzhouwan/superset-0.15.4</span><br><span class="line"></span><br><span class="line">  //...</span><br><span class="line">  sent 142935894 bytes  received 180102 bytes  3920986.19 bytes/sec</span><br><span class="line">  total size is 359739823  speedup is 2.51</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 本机 和 目标机器 的 superset 目录下校验文件数量</span></span><br><span class="line">$ find | wc -l</span><br><span class="line">  10113</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重复以上步骤，从跳板机 rsync 到线上机器</span></span><br><span class="line">$ rsync -avuz -e ssh /home/yuzhouwan/superset-0.15.4/ root@192.168.2.10:/home/superset/superset-0.15.4</span><br><span class="line"></span><br><span class="line"><span class="comment"># virtualenv 创建依赖的 python</span></span><br><span class="line">$ rsync -avuz -e ssh /root/software yuzhouwan@middle:/home/yuzhouwan</span><br><span class="line">$ rsync -avuz -e ssh /home/yuzhouwan/software root@druid-prd01:/root</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /root/software</span><br><span class="line">$ tar zxvf Python-2.7.12.tgz</span><br><span class="line">$ <span class="built_in">cd</span> Python-2.7.12</span><br><span class="line"></span><br><span class="line">$ ./configure --prefix=/usr --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ /sbin/ldconfig -v | grep /		<span class="comment"># nessnary!!</span></span><br><span class="line">$ python -V</span><br><span class="line">  Python 2.7.12</span><br></pre></td></tr></tbody></table></figure>
<h4 id="动态链接库"><a href="#动态链接库" class="headerlink" title="动态链接库"></a>动态链接库</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 虽然软链接已经 rsync 过来了，但是 目标机器相关目录下，没有对应的 Python 的动态链接库</span></span><br><span class="line">$ file /root/superset/lib/python2.7/lib-dynload</span><br><span class="line"></span><br><span class="line">  /root/superset/lib/python2.7/lib-dynload: broken symbolic link to `/usr/<span class="built_in">local</span>/python27/lib/python2.7/lib-dynload`</span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要和联网环境中，创建 VirtualEnv 时的 Python 全局环境一致</span></span><br><span class="line">$ ./configure --prefix=/usr/<span class="built_in">local</span>/python27 --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ /sbin/ldconfig -v | grep /</span><br><span class="line"></span><br><span class="line">$ ls /usr/<span class="built_in">local</span>/python27/lib/python2.7/lib-dynload -sail</span><br></pre></td></tr></tbody></table></figure>
<h4 id="用户权限"><a href="#用户权限" class="headerlink" title="用户权限"></a>用户权限</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建用户</span></span><br><span class="line">$ adduser superset</span><br><span class="line">$ <span class="built_in">cd</span> /home/superset</span><br><span class="line"><span class="comment"># 如果存在版本号，需要创建 软链接</span></span><br><span class="line">$ chown -R superset:superset superset-0.15.4</span><br><span class="line">$ ln -s superset-0.15.4 superset</span><br><span class="line"></span><br><span class="line">$ chown -h superset:superset superset</span><br><span class="line">$ su - superset</span><br></pre></td></tr></tbody></table></figure>
<h4 id="元数据存储"><a href="#元数据存储" class="headerlink" title="元数据存储"></a>元数据存储</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改数据库</span></span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line"></span><br><span class="line">  <span class="comment"># SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(DATA_DIR, 'superset.db')</span></span><br><span class="line">  SQLALCHEMY_DATABASE_URI = <span class="string">'mysql+pymysql://user:password@mysql01:3306/superset1?charset=utf8'</span></span><br><span class="line"></span><br><span class="line">$ mysql -hmysql01 -p3306 -uuser -ppassword</span><br><span class="line">&gt; use superset1;</span><br><span class="line">&gt; show tables;</span><br><span class="line">  +-------------------------+</span><br><span class="line">  | Tables_in_superset1     |</span><br><span class="line">  +-------------------------+</span><br><span class="line">  | ab_permission           |</span><br><span class="line">  | ...                     |</span><br><span class="line">  | url                     |</span><br><span class="line">  +-------------------------+</span><br><span class="line">  28 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line"><span class="comment"># mysqldump -hmysql01 -p3306 -uuser -ppassword superset1 &gt; superset1.sql</span></span><br><span class="line">$ mysqldump -hmysql01 -p3306 -uuser -ppassword --single-transaction superset1 &gt; superset1.sql</span><br></pre></td></tr></tbody></table></figure>
<h4 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /home/superset/superset-0.15.4</span><br><span class="line">$ <span class="built_in">source</span> bin/activate</span><br><span class="line">$ mkdir logs</span><br><span class="line">$ nohup superset runserver -a 0.0.0.0 -p 9097 2&gt;&amp;1 -w 4 &gt; logs/superset.log &amp;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="本地运行"><a href="#本地运行" class="headerlink" title="本地运行"></a>本地运行</h2><h3 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h3><h4 id="Windows-相关"><a href="#Windows-相关" class="headerlink" title="Windows 相关"></a>Windows 相关</h4><h5 id="Microsoft-Visual-C-9-0-is-required-Unable-to-find-vcvarsall-bat"><a href="#Microsoft-Visual-C-9-0-is-required-Unable-to-find-vcvarsall-bat" class="headerlink" title="Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat)"></a>Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat)</h5><h6 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h6><p>　error: Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat). Get it from <code>http://aka.ms/vcpython27</code></p>
<h6 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pip install wheel setuptools</span><br><span class="line"><span class="comment"># VCForPython27.msi 下载安装</span></span><br></pre></td></tr></tbody></table></figure>
<h5 id="‘openssl-opensslv-h’-No-such-file-or-directory"><a href="#‘openssl-opensslv-h’-No-such-file-or-directory" class="headerlink" title="‘openssl/opensslv.h’: No such file or directory"></a>‘openssl/opensslv.h’: No such file or directory</h5><h6 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># download openssl-0.9.8h-1-setup.exe from http://gnuwin32.sourceforge.net/packages/openssl.htm</span></span><br></pre></td></tr></tbody></table></figure>
<h5 id="Cannot-open-include-file-‘stdint-h’-No-such-file-or-directory"><a href="#Cannot-open-include-file-‘stdint-h’-No-such-file-or-directory" class="headerlink" title="Cannot open include file: ‘stdint.h’: No such file or directory"></a>Cannot open include file: ‘stdint.h’: No such file or directory</h5><h6 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Microsoft Visual C++ 2015 Redistributable Update 3</span></span><br><span class="line"><span class="comment"># download vc_redist.x64.exe from https://www.microsoft.com/zh-CN/download/details.aspx?id=53840</span></span><br><span class="line">$ vim D:\apps\Python27\Lib\distutils\msvc9compiler.py</span><br><span class="line"></span><br><span class="line">  def get_build_version():</span><br><span class="line">    <span class="built_in">return</span> 9.0</span><br><span class="line">  def find_vcvarsall(version):</span><br><span class="line">    <span class="built_in">return</span> r<span class="string">'C:\Users\yuzhouwan\AppData\Local\Programs\Common\Microsoft\Visual C++ for Python\9.0\vcvarsall.bat'</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> superset-0.15.4</span><br><span class="line">$ python setup.py install</span><br><span class="line"></span><br><span class="line"><span class="comment"># Microsoft 提供的 VCForPython27.msi 默认使用 VC2008，而 stdint.h 是从 VC2012 开始支持的</span></span><br><span class="line"><span class="comment"># 2014 年之后，VCForPython27.msi 便不再维护，决定尝试用 ubuntu or remote debug ...</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="Python相关"><a href="#Python相关" class="headerlink" title="Python相关"></a>Python相关</h4><h5 id="Make-sure-that-you-use-the-correct-version-of-‘pip’"><a href="#Make-sure-that-you-use-the-correct-version-of-‘pip’" class="headerlink" title="Make sure that you use the correct version of ‘pip’"></a>Make sure that you use the correct version of ‘pip’</h5><h6 id="描述-1"><a href="#描述-1" class="headerlink" title="描述"></a>描述</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Try to run this <span class="built_in">command</span> from the system terminal. Make sure that you use the correct version of <span class="string">'pip'</span> installed <span class="keyword">for</span> your Python interpreter located at <span class="string">'D:\apps\Python27\python.exe'</span></span><br></pre></td></tr></tbody></table></figure>
<h6 id="解决-3"><a href="#解决-3" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 pip，下载 https://bootstrap.pypa.io/get-pip.py 安装文件</span></span><br><span class="line">$ python get-pip.py</span><br><span class="line"></span><br><span class="line">$ pip --version</span><br><span class="line">  pip 8.1.1 from d:\apps\python27\lib\site-packages (python 2.7)</span><br></pre></td></tr></tbody></table></figure>
<h5 id="‘Connection-to-pypi-python-org-timed-out-connect-timeout-15-’"><a href="#‘Connection-to-pypi-python-org-timed-out-connect-timeout-15-’" class="headerlink" title="‘Connection to pypi.python.org timed out. (connect timeout=15)’"></a>‘Connection to pypi.python.org timed out. (connect timeout=15)’</h5><h6 id="描述-2"><a href="#描述-2" class="headerlink" title="描述"></a>描述</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ pip install --upgrade pip</span><br><span class="line">  <span class="string">'Connection to pypi.python.org timed out. (connect timeout=15)'</span></span><br></pre></td></tr></tbody></table></figure>
<h6 id="解决-4"><a href="#解决-4" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置 proxy</span></span><br><span class="line">$ <span class="built_in">export</span> https_proxy=<span class="string">"http://10.10.10.10:8080"</span></span><br><span class="line">$ pip install --upgrade pip</span><br><span class="line">$ pip --version</span><br><span class="line">  pip 9.0.1 from d:\apps\python27\lib\site-packages (python 2.7)</span><br></pre></td></tr></tbody></table></figure>
<h5 id="setup-py-failed-with-error-code-1"><a href="#setup-py-failed-with-error-code-1" class="headerlink" title="setup.py failed with error code 1"></a>setup.py failed with error code 1</h5><h6 id="描述-3"><a href="#描述-3" class="headerlink" title="描述"></a>描述</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Command <span class="string">"d:\apps\python27\python.exe -u -c "</span>import setuptools, tokenize;__file__=<span class="string">'c:\\users\\yuzhouwan\\appdata\\local\\temp\\pip-build-zzbhrq\\sasl\\setup.py'</span>;f=getattr(tokenize, <span class="string">'open'</span>, open)(__file__);code=f.read().replace(<span class="string">'\r\n'</span>, <span class="string">'\n'</span>);f.close();<span class="built_in">exec</span>(compile(code, __file__, <span class="string">'exec'</span>))<span class="string">" install --record c:\users\yuzhouwan\appdata\local\temp\pip-erwavd-record\install-record.txt --single-version-externally-managed --compile"</span> failed with error code 1 <span class="keyword">in</span> c:\users\yuzhouwan\appdata\<span class="built_in">local</span>\temp\pip-build-zzbhrq\sasl\</span><br></pre></td></tr></tbody></table></figure>
<h6 id="解决-5"><a href="#解决-5" class="headerlink" title="解决"></a>解决</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ pip install --upgrade setuptools pip</span><br><span class="line">$ pip install superset</span><br><span class="line"></span><br><span class="line"><span class="comment"># Download superset-0.15.4.tar.gz from https://pypi.python.org/pypi/superset</span></span><br><span class="line">$ tar zxvf superset-0.15.4.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> superset-0.15.4</span><br><span class="line">$ python setup.py install</span><br></pre></td></tr></tbody></table></figure>
<h2 id="基于-K8S-环境部署"><a href="#基于-K8S-环境部署" class="headerlink" title="基于 K8S 环境部署"></a>基于 <a href="https://yuzhouwan.com/posts/200919/">K8S</a> 环境部署</h2><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ helm install superset stable/superset --version 1.1.11</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">NAME: superset</span><br><span class="line">LAST DEPLOYED: Mon Jul 19 08:45:33 2020</span><br><span class="line">NAMESPACE: default</span><br><span class="line">STATUS: deployed</span><br><span class="line">REVISION: 1</span><br><span class="line">TEST SUITE: None</span><br><span class="line">NOTES:</span><br><span class="line">Superset can be accessed via port 9000 on the following DNS name from within your cluster:</span><br><span class="line">superset.default.svc.cluster.local</span><br><span class="line"></span><br><span class="line">Initially you can login with username/password: admin/admin.</span><br><span class="line">WARNING: Persistence is DISABLED !</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl <span class="built_in">exec</span> -it superset-65c7696586-lhwpp bash</span><br><span class="line">$ <span class="built_in">export</span> FLASK_APP=superset &amp;&amp; flask fab create-admin</span><br><span class="line">$ <span class="built_in">exit</span></span><br><span class="line">$ <span class="built_in">kill</span> `ps -ef | grep 8088 | grep -v grep | awk <span class="string">'{print $2}'</span>`; <span class="built_in">export</span> POD_NAME=$(kubectl get pods | grep superset | awk <span class="string">'{print $1}'</span>) ; nohup kubectl port-forward <span class="variable">$POD_NAME</span> 8088:8088 --address 0.0.0.0 2&gt;&amp;1 &amp;</span><br><span class="line">$ open <span class="string">'http://localhost:8088/login/'</span></span><br></pre></td></tr></tbody></table></figure>
<p><img data-src="/picture/superset/apache_superset_login.png" alt="Apache Superset Login"><br><img data-src="/picture/superset/apache_superset_dashboards.png" alt="Apache Superset Dashboards"></p>
<center>（对 <a href="https://superset.apache.org/" target="_blank" rel="external nofollow noopener noreferrer">Apache Superset</a>™ 可视化页面的截图）</center>





<h2 id="开发环境搭建"><a href="#开发环境搭建" class="headerlink" title="开发环境搭建"></a>开发环境搭建</h2><h3 id="依赖-1"><a href="#依赖-1" class="headerlink" title="依赖"></a>依赖</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/software</span><br><span class="line">$ tar zxvf Python-2.7.12.tgz</span><br><span class="line">$ <span class="built_in">cd</span> Python-2.7.12</span><br><span class="line"></span><br><span class="line">$ ./configure --prefix=/usr/<span class="built_in">local</span>/python27 --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ /sbin/ldconfig -v | grep /</span><br><span class="line">$ python -V</span><br><span class="line">$ Python 2.7.12</span><br><span class="line"></span><br><span class="line">$ mv /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/python_bak</span><br><span class="line">$ ln -s /usr/<span class="built_in">local</span>/python27/bin/python /usr/<span class="built_in">local</span>/bin/python</span><br></pre></td></tr></tbody></table></figure>
<h3 id="虚拟环境"><a href="#虚拟环境" class="headerlink" title="虚拟环境"></a>虚拟环境</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root</span><br><span class="line">$ virtualenv -p /usr/<span class="built_in">local</span>/bin/python --system-site-packages env</span><br><span class="line">$ <span class="built_in">cd</span> env</span><br><span class="line">$ mkdir code</span><br></pre></td></tr></tbody></table></figure>
<h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># windows</span></span><br><span class="line">$ <span class="built_in">cd</span> E:\Github\super\env</span><br><span class="line">$ git init</span><br><span class="line">$ git remote add origin master https://github.com/asdf2014/superset.git</span><br><span class="line">$ git pull origin master</span><br><span class="line"></span><br><span class="line"><span class="comment"># SFTP</span></span><br><span class="line"><span class="comment"># 上传到 /root/env/code</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/env/code</span><br><span class="line">$ <span class="built_in">source</span> /root/env/bin/activate</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /root/env/code/superset/static</span><br><span class="line">$ mv assets assets_bak</span><br><span class="line">$ ln -s ../assets assets</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /root/env/code</span><br><span class="line">$ python setup.py develop</span><br><span class="line"></span><br><span class="line">  Finished processing dependencies <span class="keyword">for</span> superset==0.15.4</span><br><span class="line"></span><br><span class="line">$ pip freeze | grep superset</span><br><span class="line">  superset==0.15.4</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create an admin user</span></span><br><span class="line">$ fabmanager create-admin --app superset</span><br><span class="line"></span><br><span class="line">  Username [admin]:        <span class="comment"># login name</span></span><br><span class="line">  User first name [admin]: <span class="comment"># first name</span></span><br><span class="line">  User last name [user]:   <span class="comment"># lastname</span></span><br><span class="line">  Email [admin@fab.org]:   <span class="comment"># email, must unique</span></span><br><span class="line">  Password: </span><br><span class="line">  Repeat <span class="keyword">for</span> confirmation: </span><br><span class="line">  Error: the two entered values <span class="keyword">do</span> not match</span><br><span class="line">  Password:			 	  <span class="comment">#superset</span></span><br><span class="line">  Repeat <span class="keyword">for</span> confirmation: <span class="comment">#superset</span></span><br><span class="line">  // ...</span><br><span class="line">  Recognized Database Authentications.</span><br><span class="line">  2016-12-14 17:53:40,945:INFO:flask_appbuilder.security.sqla.manager:Added user superset db upgrade</span><br><span class="line">  Admin User superset db upgrade created.</span><br><span class="line"></span><br><span class="line">$ superset db upgrade</span><br><span class="line">$ superset init</span><br><span class="line">$ superset load_examples</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Npm"><a href="#Npm" class="headerlink" title="Npm"></a>Npm</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># [Mac OS]</span></span><br><span class="line">$ sudo yum group install <span class="string">"Development Tools"</span> --<span class="built_in">setopt</span>=group_package_types=mandatory,default,optional --skip-broken -y</span><br><span class="line">$ sudo yum install curl git m4 ruby texinfo bzip2-devel curl-devel expat-devel ncurses-devel zlib-devel -y</span><br><span class="line"></span><br><span class="line"><span class="comment"># ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/linuxbrew/go/install)"    # Do not run this as root!</span></span><br><span class="line">$ wget https://raw.githubusercontent.com/Homebrew/linuxbrew/go/install --no-check-certificate</span><br><span class="line">$ mv install install.rb</span><br><span class="line">$ vim install.rb</span><br><span class="line"></span><br><span class="line">　<span class="comment"># abort "Don't run this as root!" if Process.uid == 0</span></span><br><span class="line"></span><br><span class="line">$ mkdir -p /root/.linuxbrew/bin</span><br><span class="line">$ <span class="built_in">export</span> PATH=<span class="string">"/root/.linuxbrew/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line">$ ruby install.rb</span><br><span class="line"></span><br><span class="line">$ vim ~/.bashrc</span><br><span class="line"></span><br><span class="line">　<span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$HOME</span>/.linuxbrew/bin:<span class="variable">$PATH</span>"</span></span><br><span class="line">　<span class="built_in">export</span> MANPATH=<span class="string">"<span class="variable">$HOME</span>/.linuxbrew/share/man:<span class="variable">$MANPATH</span>"</span></span><br><span class="line">　<span class="built_in">export</span> INFOPATH=<span class="string">"<span class="variable">$HOME</span>/.linuxbrew/share/info:<span class="variable">$INFOPATH</span>"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># [CentOS]</span></span><br><span class="line">$ yum install npm</span><br><span class="line">$ <span class="built_in">cd</span> /root/env/code/superset/assets	<span class="comment"># package.json</span></span><br><span class="line">$ npm install</span><br><span class="line"></span><br><span class="line"><span class="comment"># if visit https://github.com/jquery/jquery.git return timeout</span></span><br><span class="line">$ vim /etc/hosts</span><br><span class="line"></span><br><span class="line">　192.30.253.112 github.com</span><br><span class="line">　151.101.100.133 assets-cdn.github.com</span><br><span class="line">　192.30.253.117 api.github.com</span><br><span class="line">　192.30.253.121 codeload.github.com</span><br></pre></td></tr></tbody></table></figure>
<h3 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/env/code</span><br><span class="line">$ chmod 777 *sh</span><br><span class="line">$ <span class="built_in">cd</span> /root/env/code/superset/bin</span><br><span class="line">$ chmod 777 superset</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /root/env/code</span><br><span class="line">$ bash run_tests.sh</span><br></pre></td></tr></tbody></table></figure>
<h3 id="IDE-中远程开发"><a href="#IDE-中远程开发" class="headerlink" title="IDE 中远程开发"></a>IDE 中远程开发</h3><h4 id="Remote-Debug"><a href="#Remote-Debug" class="headerlink" title="Remote Debug"></a>Remote Debug</h4><p>　详见我的另一篇博客中 Remote Debug 部分：《<a href="https://yuzhouwan.com/posts/43687/#Remote-Debug">Python</a>》</p>
<h2 id="二次开发"><a href="#二次开发" class="headerlink" title="二次开发"></a>二次开发</h2><h3 id="Others-Category"><a href="#Others-Category" class="headerlink" title="Others Category"></a>Others Category</h3><h4 id="描述-4"><a href="#描述-4" class="headerlink" title="描述"></a>描述</h4><p>　对 <a href="https://yuzhouwan.com/posts/45888/">HBase</a> 的 Region 层面进行聚合，group 出来的 Region 会很多，在 <code>DistributionPieViz</code> 中展示会很卡顿，而且不美观</p>
<h4 id="解决-6"><a href="#解决-6" class="headerlink" title="解决"></a>解决</h4><h5 id="增加-row-limit-可以排除-topN-之外的数据"><a href="#增加-row-limit-可以排除-topN-之外的数据" class="headerlink" title="增加 row_limit 可以排除 topN 之外的数据"></a>增加 row_limit 可以排除 topN 之外的数据</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/superset-0.15.4</span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/viz.py</span><br><span class="line"></span><br><span class="line">  fieldsets = ({</span><br><span class="line">    <span class="string">'label'</span>: None,</span><br><span class="line">    <span class="string">'fields'</span>: (</span><br><span class="line">      <span class="string">'metrics'</span>, <span class="string">'groupby'</span>,</span><br><span class="line">      <span class="string">'limit'</span>,</span><br><span class="line">      <span class="string">'pie_label_type'</span>,</span><br><span class="line">      (<span class="string">'donut'</span>, <span class="string">'show_legend'</span>),</span><br><span class="line">      <span class="string">'labels_outside'</span>,</span><br><span class="line">      <span class="string">'row_limit'</span>,</span><br><span class="line">    )</span><br><span class="line">  },)</span><br></pre></td></tr></tbody></table></figure>
<h5 id="others-category-将-topN-之外的数据聚合"><a href="#others-category-将-topN-之外的数据聚合" class="headerlink" title="others_category 将 topN 之外的数据聚合"></a>others_category 将 topN 之外的数据聚合</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/superset-0.15.4</span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/viz.py</span><br><span class="line"></span><br><span class="line">  fieldsets = ({</span><br><span class="line">    <span class="string">'label'</span>: None,</span><br><span class="line">    <span class="string">'fields'</span>: (</span><br><span class="line">      <span class="string">'metrics'</span>, <span class="string">'groupby'</span>,</span><br><span class="line">      <span class="string">'limit'</span>,</span><br><span class="line">      <span class="string">'pie_label_type'</span>,</span><br><span class="line">      (<span class="string">'donut'</span>, <span class="string">'show_legend'</span>),</span><br><span class="line">      <span class="string">'labels_outside'</span>,</span><br><span class="line">      <span class="string">'row_limit'</span>,</span><br><span class="line">      <span class="string">'others_category'</span>,</span><br><span class="line">    )</span><br><span class="line">  },)</span><br><span class="line"></span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/forms.py</span><br><span class="line"></span><br><span class="line">  <span class="string">'others_category'</span>: (BetterBooleanField, {</span><br><span class="line">    <span class="string">"label"</span>: _(<span class="string">"Others category"</span>),</span><br><span class="line">    <span class="string">"default"</span>: True,</span><br><span class="line">    <span class="string">"description"</span>: _(<span class="string">"Aggregate data outside of topN into a single category"</span>)</span><br><span class="line">  }),</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># models.py</span></span><br><span class="line"><span class="comment"># Others 类别，没有被排在最后，而是重新又进行了一次排序</span></span><br><span class="line"><span class="comment"># "others_category": "y" 属性没有传递下来</span></span><br><span class="line"></span><br><span class="line">self.status = None</span><br><span class="line">self.error_message = None</span><br><span class="line">self.others_category = form_data.get(<span class="string">"others_category"</span>)</span><br><span class="line"></span><br><span class="line">top_n = 10</span><br><span class="line"><span class="keyword">if</span> top_n &gt; 0:</span><br><span class="line">df_head = df.head(top_n)</span><br><span class="line">df_tail = df.tail(len(df) - 10)</span><br><span class="line">other_metrics_sum = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0, len(metrics) - 1):</span><br><span class="line">  metric = metrics[i]</span><br><span class="line">  other_metrics_sum[i] = df_tail[metric].sum()</span><br><span class="line">df_other = pd.DataFrame([[<span class="string">'Others'</span>, other_metrics_sum]], columns=df.columns)</span><br><span class="line">df = df_head.append(df_other, ignore_index=True)</span><br></pre></td></tr></tbody></table></figure>
<p>Tips: 已提 RP#2176 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pull/2176">Aggregate data outside of topN into a single category</a></p>
<h3 id="Y-轴数据异常"><a href="#Y-轴数据异常" class="headerlink" title="Y 轴数据异常"></a>Y 轴数据异常</h3><h4 id="描述-5"><a href="#描述-5" class="headerlink" title="描述"></a>描述</h4><p>　Y 轴本应该是 0 的起点，变成 -997m 负数</p>
<h4 id="解决-7"><a href="#解决-7" class="headerlink" title="解决"></a>解决</h4><p>　已提 RP#2307 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/issues/2307">Some problem in Y Axis</a></p>
<h2 id="后期优化"><a href="#后期优化" class="headerlink" title="后期优化"></a>后期优化</h2><h3 id="MySQL-时区问题"><a href="#MySQL-时区问题" class="headerlink" title="MySQL 时区问题"></a>MySQL 时区问题</h3><h4 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h4><h5 id="描述-6"><a href="#描述-6" class="headerlink" title="描述"></a>描述</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ lib/python2.7/site-packages/superset/config.py</span><br><span class="line"></span><br><span class="line">　from dateutil import tz</span><br><span class="line"></span><br><span class="line">　<span class="comment"># Druid query timezone</span></span><br><span class="line">　<span class="comment"># tz.tzutc() : Using utc timezone</span></span><br><span class="line">　<span class="comment"># tz.tzlocal() : Using local timezone</span></span><br><span class="line">　<span class="comment"># other tz can be overridden by providing a local_config</span></span><br><span class="line">　DRUID_IS_ACTIVE = True</span><br><span class="line">　DRUID_TZ = tz.tzlocal()		<span class="comment"># +08:00</span></span><br><span class="line"></span><br><span class="line">　<span class="comment"># DRUID_TZ = tz.gettz('Asia/Shanghai')</span></span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-8"><a href="#解决-8" class="headerlink" title="解决"></a>解决</h5><p>　已提 RP#2143 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pull/2143">Using the time zone with specific name for querying Druid</a></p>
<h4 id="展示"><a href="#展示" class="headerlink" title="展示"></a>展示</h4><h5 id="描述-7"><a href="#描述-7" class="headerlink" title="描述"></a>描述</h5><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dttm.tz_convert(dttm.tzinfo._filename.split(<span class="string">'zoneinfo/'</span>)[<span class="number">1</span>]) - pytz.timezone(dttm.tzinfo._filename.split(<span class="string">'zoneinfo/'</span>)[<span class="number">1</span>]).localize(EPOCH)</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-9"><a href="#解决-9" class="headerlink" title="解决"></a>解决</h5><p>　已提 RP#2370 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pull/2370">Fix timezone issues in slices</a></p>
<h3 id="Superset-升级"><a href="#Superset-升级" class="headerlink" title="Superset 升级"></a>Superset 升级</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接利用 pip install 的方式进行升级</span></span><br><span class="line">$ pip freeze | grep superset</span><br><span class="line">$ superset==0.13.2</span><br><span class="line"></span><br><span class="line">$ pip install superset==-1</span><br><span class="line">  versions: 0.12.0, 0.13.0, 0.13.1, 0.13.2, 0.14.0, 0.14.1, 0.15.0, 0.15.1, 0.15.3, 0.15.4</span><br><span class="line"></span><br><span class="line">$ pip install superset==0.15.4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 发现之前的配置数据 都消失了，需要做一些 config 的调整</span></span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(DATA_DIR, 'superset.db')</span></span><br><span class="line">  SQLALCHEMY_DATABASE_URI = <span class="string">'mysql+pymysql://root:root@192.168.1.12:3306/superset?charset=utf8'</span></span><br><span class="line"></span><br><span class="line">$ vim /root/superset-0.15.4/bin/activate</span><br><span class="line"></span><br><span class="line">  <span class="comment"># VIRTUAL_ENV="/root/superset"</span></span><br><span class="line">  VIRTUAL_ENV=<span class="string">"/root/superset-0.15.4"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># then could just run "superset runserver -a 0.0.0.0 -p 9097"</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="Unknown-column-‘datasources-filter-select-enabled’-in-‘field-list’"><a href="#Unknown-column-‘datasources-filter-select-enabled’-in-‘field-list’" class="headerlink" title="Unknown column ‘datasources.filter_select_enabled’ in ‘field list’"></a>Unknown column ‘datasources.filter_select_enabled’ in ‘field list’</h4><h5 id="描述-8"><a href="#描述-8" class="headerlink" title="描述"></a>描述</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InternalError: (pymysql.err.InternalError) (1054, u<span class="string">"Unknown column 'datasources.filter_select_enabled' in 'field list'"</span>) [SQL: u<span class="string">'SELECT datasources.created_on AS datasources_created_on, datasources.changed_on AS datasources_changed_on, datasources.id AS datasources_id, datasources.datasource_name AS datasources_datasource_name, datasources.is_featured AS datasources_is_featured, datasources.is_hidden AS datasources_is_hidden, datasources.filter_select_enabled AS datasources_filter_select_enabled, datasources.description AS datasources_description, datasources.default_endpoint AS datasources_default_endpoint, datasources.user_id AS datasources_user_id, datasources.cluster_name AS datasources_cluster_name, datasources.offset AS datasources_offset, datasources.cache_timeout AS datasources_cache_timeout, datasources.params AS datasources_params, datasources.perm AS datasources_perm, datasources.changed_by_fk AS datasources_changed_by_fk, datasources.created_by_fk AS datasources_created_by_fk \nFROM datasources \nWHERE datasources.datasource_name = %(datasource_name_1)s \n LIMIT %(param_1)s'</span>] [parameters: {u<span class="string">'param_1'</span>: 1, u<span class="string">'datasource_name_1'</span>: u<span class="string">'bi-dfp-oms-detail'</span>}]</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-10"><a href="#解决-10" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ superset db upgrade</span><br><span class="line">$ superset refresh_druid</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Issues-with-Druid-timezones"><a href="#Issues-with-Druid-timezones" class="headerlink" title="Issues with Druid timezones"></a>Issues with Druid timezones</h4><h5 id="描述-9"><a href="#描述-9" class="headerlink" title="描述"></a>描述</h5><p>　Those methods that named tzutc and tzlocal in tz work for me…<br>　Oh no.. They are not working when i upgrade superset from v0.13.2 into v0.15.4, even if i try to use DRUID_TZ = tz.gettz(‘Asia/Shanghai’) :-(</p>
<p>　详见：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/issues/1369">Issues with Druid timezones #1369</a></p>
<h5 id="解决-11"><a href="#解决-11" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">cd</span> /root/superset-0.15.4</span><br><span class="line">$ ./bin/python -m pip freeze | grep superset</span><br><span class="line"></span><br><span class="line">  superset==0.13.2</span><br><span class="line"></span><br><span class="line">$ ./bin/python -m pip uninstall superset</span><br><span class="line">$ ./bin/python -m pip install superset==0.15.4</span><br><span class="line">$ ./bin/python -m pip freeze | grep superset</span><br><span class="line"></span><br><span class="line">  superset==0.15.4</span><br><span class="line"></span><br><span class="line">$ ./bin/python ./bin/easy_install lib/pycharm-debug.egg</span><br><span class="line"><span class="comment"># config remote python</span></span><br><span class="line"></span><br><span class="line">$ ./bin/python ./bin/superset runserver -a 0.0.0.0 -p 9097</span><br><span class="line"><span class="comment"># nohup ./bin/python ./bin/superset runserver -a 0.0.0.0 -p 9097 2&gt;&amp;1 &gt; logs/superset.log &amp;</span></span><br><span class="line"></span><br><span class="line">$ ./bin/python ./bin/superset db upgrade</span><br><span class="line">$ ./bin/python ./bin/superset refresh_druid</span><br></pre></td></tr></tbody></table></figure>
<h4 id="pydevd-无法进行-remote-debug"><a href="#pydevd-无法进行-remote-debug" class="headerlink" title="pydevd 无法进行 remote debug"></a>pydevd 无法进行 remote debug</h4><h5 id="描述-10"><a href="#描述-10" class="headerlink" title="描述"></a>描述</h5><p>　版本从 0.13.2 升级到 0.15.4，在 debug 的时候会启动两个进程（会导致 pydevd 无法进行 remote debug）</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ps -ef | grep superset | grep -v grep</span><br><span class="line"></span><br><span class="line">  root     22567  1632 19 12:05 pts/0    00:00:03 ./bin/python ./bin/superset runserver -d -p 9097</span><br><span class="line">  root     22578 22567 24 12:05 pts/0    00:00:03 /root/superset-0.15.4/bin/python ./bin/superset runserver -d -p 9097</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-12"><a href="#解决-12" class="headerlink" title="解决"></a>解决</h5><h6 id="直接用-cli-py-启动-—not-ok"><a href="#直接用-cli-py-启动-—not-ok" class="headerlink" title="直接用 cli.py 启动    —not ok"></a>直接用 cli.py 启动    —not ok</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ vim ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line"></span><br><span class="line">  <span class="comment"># append</span></span><br><span class="line">  manager.run()</span><br><span class="line"></span><br><span class="line">$ ./bin/python ./lib/python2.7/site-packages/superset/cli.py runserver -a 0.0.0.0  -p 9097</span><br><span class="line"></span><br><span class="line">$ ps -ef | grep superset | grep -v grep</span><br><span class="line"></span><br><span class="line">  root     25238  1632 35 13:07 pts/0    00:00:03 ./bin/python ./lib/python2.7/site-packages/superset/cli.py runserver -d -p 9097</span><br><span class="line">  root     25247 25238 55 13:07 pts/0    00:00:03 /root/superset-0.15.4/bin/python ./lib/python2.7/site-packages/superset/cli.py runserver -d -p 9097</span><br></pre></td></tr></tbody></table></figure>
<h6 id="尝试解决-WARNING-werkzeug-Debugger-is-active-问题"><a href="#尝试解决-WARNING-werkzeug-Debugger-is-active-问题" class="headerlink" title="尝试解决 WARNING:werkzeug: * Debugger is active! 问题"></a>尝试解决 WARNING:werkzeug: * Debugger is active! 问题</h6><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ vim lib/python2.7/site-packages/werkzeug/serving.py</span><br><span class="line"></span><br><span class="line">  class ThreadedWSGIServer(ThreadingMixIn, BaseWSGIServer):</span><br><span class="line"></span><br><span class="line">    <span class="string">""</span><span class="string">"A WSGI server that does threading."</span><span class="string">""</span></span><br><span class="line">    multithread = True</span><br><span class="line"></span><br><span class="line">$ vim lib/python2.7/site-packages/flask/app.py</span><br><span class="line"></span><br><span class="line">  options.setdefault(<span class="string">'use_reloader'</span>, self.debug)</span><br><span class="line"></span><br><span class="line">$ superset/__init__.py</span><br></pre></td></tr></tbody></table></figure>
<p>　已提 RP#2136 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pull/2136">Fix werkzeug instance was created twice in Debug Mode</a></p>
<h3 id="Sqlite3-切换为-MySQL"><a href="#Sqlite3-切换为-MySQL" class="headerlink" title="Sqlite3 切换为 MySQL"></a>Sqlite3 切换为 MySQL</h3><h4 id="尝试-SQLite-自带的-dump-命令"><a href="#尝试-SQLite-自带的-dump-命令" class="headerlink" title="尝试 SQLite 自带的 dump 命令"></a>尝试 SQLite 自带的 dump 命令</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># superset01				192.168.1.10		Superset</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/.superset</span><br><span class="line">$ ll -sail</span><br><span class="line"></span><br><span class="line">  1285 43256 -rw-r--r--   1 root root 44288000 Jan 22 14:06 superset.db</span><br><span class="line"></span><br><span class="line">$ sqlite3 superset.db</span><br><span class="line">  sqlite&gt; .databases</span><br><span class="line">  seq  name             file                                                      </span><br><span class="line">  ---  ---------------  ----------------------------------------------------------</span><br><span class="line">  0    main             /root/.superset/superset.db</span><br><span class="line"></span><br><span class="line">  sqlite&gt; .tables</span><br><span class="line">  ab_permission            columns                  multiformat_time_series</span><br><span class="line">  ab_permission_view       css_templates            query                  </span><br><span class="line">  ab_permission_view_role  dashboard_slices         random_time_series     </span><br><span class="line">  ab_register_user         dashboard_user           slice_user             </span><br><span class="line">  ab_role                  dashboards               slices                 </span><br><span class="line">  ab_user                  datasources              sql_metrics            </span><br><span class="line">  ab_user_role             dbs                      table_columns          </span><br><span class="line">  ab_view_menu             energy_usage             tables                 </span><br><span class="line">  access_request           favstar                  url                    </span><br><span class="line">  alembic_version          logs                     wb_health_population   </span><br><span class="line">  birth_names              long_lat               </span><br><span class="line">  clusters                 metrics                </span><br><span class="line"></span><br><span class="line"><span class="comment"># not suit for mysql</span></span><br><span class="line"><span class="comment"># sqlite&gt; .output superset.sql</span></span><br><span class="line"><span class="comment"># sqlite&gt; .dump</span></span><br><span class="line"></span><br><span class="line">$ vim dump_for_mysql.py</span><br><span class="line"></span><br><span class="line">  <span class="comment"># https://github.com/EricHigdon/sqlite3tomysql</span></span><br><span class="line"></span><br><span class="line">$ sqlite3 superset.db .dump | python dump_for_mysql.py &gt; superset.sql</span><br><span class="line"></span><br><span class="line">$ ls -sail</span><br><span class="line"></span><br><span class="line">  1285 43256 -rw-r--r--   1 root root 44288000 Jan 22 14:06 superset.db</span><br><span class="line">  18631 76968 -rw-r--r--   1 root root 78812197 Jan 22 14:35 superset.sql</span><br><span class="line"></span><br><span class="line">$ vim superset.sql</span><br><span class="line"></span><br><span class="line">  id INTEGER NOT NULL, </span><br><span class="line">  <span class="comment"># 替换为 (主键) 自增长</span></span><br><span class="line">  id INTEGER PRIMARY KEY NOT NULL AUTO_INCREMENT, </span><br><span class="line"></span><br><span class="line">$ scp superset.sql root@192.168.1.12:/home/mysql</span><br></pre></td></tr></tbody></table></figure>
<h4 id="自己实现-sqlite3tomysql-py"><a href="#自己实现-sqlite3tomysql-py" class="headerlink" title="自己实现 sqlite3tomysql.py"></a>自己实现 sqlite3tomysql.py</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># druid02    192.168.1.12    MySQL</span></span><br><span class="line">$ ps -ef | grep mysql | grep -v druid | grep -v grep</span><br><span class="line"></span><br><span class="line">  mysql    11435  8530  0 14:13 pts/4    00:00:00 /bin/sh /home/mysql/bin/mysqld_safe --defaults-file=/home/mysql/my.cnf</span><br><span class="line">  mysql    12192 11435  0 14:13 pts/4    00:00:00 /home/mysql/bin/mysqld --defaults-file=/home/mysql/my.cnf --basedir=/home/mysql --datadir=/home/mysql/data --plugin-dir=/home/mysql/lib/mysql/plugin --log-error=/home/mysql/data/druid02.err --open-files-limit=8192 --pid-file=/home/mysql/data/druid02.pid --socket=/home/mysql/data/mysql.sock --port=3306</span><br><span class="line">  mysql    12223  8530  0 14:13 pts/4    00:00:00 mysql -uroot -p -S /home/mysql/data/mysql.sock</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ su - mysql</span><br><span class="line">$ mysql -uroot -p -S /home/mysql/data/mysql.sock</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">mysql&gt; create database superset;</span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">mysql&gt; use superset;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行 sqlite3tomysql.py</span></span><br><span class="line">  mysql -uroot -p superset2 -S /home/mysql/data/mysql.sock  --default-character-set=utf8 &lt; superset.sql.schema.sql</span><br><span class="line">  mysql -uroot -p superset2 -S /home/mysql/data/mysql.sock  --default-character-set=utf8 &lt; superset.sql.data.sql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 避免表之间 外键依赖，可以在 mysql 命令行中，使用 source .superset.sql.schema.sql 的方式，多次批量导入</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="元数据存储-1"><a href="#元数据存储-1" class="headerlink" title="元数据存储"></a>元数据存储</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># superset01				192.168.1.10		Superset</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/superset</span><br><span class="line">$ find ./ -name config.py</span><br><span class="line">  ./lib/python2.7/site-packages/caravel/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/sqlalchemy/testing/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/pandas/core/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/setuptools/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/numpy/distutils/<span class="built_in">command</span>/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/gunicorn/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/panoramix/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/flask/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/alembic/testing/config.py</span><br><span class="line">  ./lib/python2.7/site-packages/alembic/config.py</span><br><span class="line"></span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line">  <span class="comment"># SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(DATA_DIR, 'superset.db')</span></span><br><span class="line">  SQLALCHEMY_DATABASE_URI = <span class="string">'mysql+pymysql://root:root@192.168.1.12:3306/superset?charset=utf8'</span></span><br></pre></td></tr></tbody></table></figure>
<h4 id="启动-1"><a href="#启动-1" class="headerlink" title="启动"></a>启动</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先执行，一系列 superset 初始化工作</span></span><br><span class="line">$ nohup superset runserver -a 0.0.0.0 -p 9097 -w 4 2&gt;&amp;1 &gt; logs/superset.log &amp;</span><br></pre></td></tr></tbody></table></figure>
<p>Tips: 代码 &amp; 操作步骤，详见：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/asdf2014/yuzhouwan/tree/master/yuzhouwan-hacker/yuzhouwan-hacker-python#convert-sqlite-into-mysql">Convert SQLite into MySQL</a></p>
<h3 id="参数调优"><a href="#参数调优" class="headerlink" title="参数调优"></a>参数调优</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 适当增加 gunicorn 的 worker 数量（default：2）</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/superset</span><br><span class="line">$ <span class="built_in">source</span> bin/activate</span><br><span class="line">$ mkdir logs</span><br><span class="line">$ nohup ./bin/python ./bin/superset runserver -a 0.0.0.0 -p 9097 -w 4 2&gt;&amp;1 &gt; logs/superset.log &amp;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h3><h4 id="ExtDeprecationWarning-Importing-flask-ext-cache-is-deprecated-use-flask-cache-instead"><a href="#ExtDeprecationWarning-Importing-flask-ext-cache-is-deprecated-use-flask-cache-instead" class="headerlink" title="ExtDeprecationWarning: Importing flask.ext.cache is deprecated, use flask_cache instead."></a>ExtDeprecationWarning: Importing flask.ext.cache is deprecated, use flask_cache instead.</h4><h5 id="描述-11"><a href="#描述-11" class="headerlink" title="描述"></a>描述</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(superset) [root@superset01 superset-0.15.4]<span class="comment"># ./bin/python ./lib/python2.7/site-packages/superset/cli.py runserver -d -p 9097</span></span><br><span class="line">/root/superset-0.15.4/lib/python2.7/site-packages/flask/exthook.py:71: ExtDeprecationWarning: Importing flask.ext.script is deprecated, use flask_script instead.</span><br><span class="line">.format(x=modname), ExtDeprecationWarning</span><br><span class="line">/root/superset-0.15.4/lib/python2.7/site-packages/flask/exthook.py:71: ExtDeprecationWarning: Importing flask.ext.sqlalchemy is deprecated, use flask_sqlalchemy instead.</span><br><span class="line">.format(x=modname), ExtDeprecationWarning</span><br><span class="line">/root/superset-0.15.4/lib/python2.7/site-packages/flask/exthook.py:71: ExtDeprecationWarning: Importing flask.ext.sqlalchemy._compat is deprecated, use flask_sqlalchemy._compat instead.</span><br><span class="line">.format(x=modname), ExtDeprecationWarning</span><br><span class="line">/root/superset-0.15.4/lib/python2.7/site-packages/flask_cache/init.py:152: UserWarning: Flask-Cache: CACHE_TYPE is <span class="built_in">set</span> to null, caching is effectively disabled.</span><br><span class="line">warnings.warn(<span class="string">"Flask-Cache: CACHE_TYPE is set to null, "</span></span><br><span class="line">/root/superset-0.15.4/lib/python2.7/site-packages/flask/exthook.py:71: ExtDeprecationWarning: Importing flask.ext.cache is deprecated, use flask_cache instead.</span><br><span class="line">.format(x=modname), ExtDeprecationWarning</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-13"><a href="#解决-13" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ vim ./bin/superset</span><br><span class="line"></span><br><span class="line">  +import warnings</span><br><span class="line">  +from flask.exthook import ExtDeprecationWarning</span><br><span class="line">  +warnings.simplefilter(<span class="string">'ignore'</span>, ExtDeprecationWarning)</span><br><span class="line">  +</span><br><span class="line">  from superset.cli import manager</span><br></pre></td></tr></tbody></table></figure>
<p>　已提 RP#2138 <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pull/2138">Fix ExtDeprecationWarning</a></p>
<h2 id="遇到的坑"><a href="#遇到的坑" class="headerlink" title="遇到的坑"></a>遇到的坑</h2><h3 id="创建-user-时，需保证-email-的唯一性"><a href="#创建-user-时，需保证-email-的唯一性" class="headerlink" title="创建 user 时，需保证 email 的唯一性"></a>创建 user 时，需保证 email 的唯一性</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Recognized Database Authentications.</span><br><span class="line">2016-12-14 18:12:36,007:ERROR:flask_appbuilder.security.sqla.manager:Error adding new user to database. (sqlite3.IntegrityError) column email is not unique [SQL: u<span class="string">'INSERT INTO ab_user (first_name, last_name, username, password, active, email, last_login, login_count, fail_login_count, created_on, changed_on, created_by_fk, changed_by_fk) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)'</span>] [parameters: (u<span class="string">'superset'</span>, u<span class="string">'yuzhouwan'</span>, u<span class="string">'superset'</span>, <span class="string">'pbkdf2:sha1:1000$e3imUMx0$83b38fb2a0f628d1379379bb353fc80697c435a1'</span>, 1, u<span class="string">'yuzhouwan@gmail.com'</span>, None, None, None, <span class="string">'2016-12-14 18:12:36.004721'</span>, <span class="string">'2016-12-14 18:12:36.004773'</span>, None, None)]</span><br><span class="line">No user created an error occured</span><br></pre></td></tr></tbody></table></figure>
<p>　使用 admin / admin 用户登录，进行修改</p>
<h3 id="缺少的依赖包"><a href="#缺少的依赖包" class="headerlink" title="缺少的依赖包"></a>缺少的依赖包</h3><h4 id="描述-12"><a href="#描述-12" class="headerlink" title="描述"></a>描述</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RuntimeError: Compression requires the (missing) zlib module</span><br></pre></td></tr></tbody></table></figure>
<h4 id="解决-14"><a href="#解决-14" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ yum install zlib</span><br><span class="line">$ yum install zlib-devel</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进到 python2.7 目录 重新编译安装，软链接不需要重建</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/software/Python-2.7.12</span><br><span class="line">$ make</span><br><span class="line">$ make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进到 setup-tools 目录 重新安装</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/software/setuptools-32.0.0</span><br><span class="line">$ python setup.py install</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Python-无法装载模块（RedHat-Problem）"><a href="#Python-无法装载模块（RedHat-Problem）" class="headerlink" title="Python 无法装载模块（RedHat Problem）"></a>Python 无法装载模块（RedHat Problem）</h3><h4 id="pip-command-not-found"><a href="#pip-command-not-found" class="headerlink" title="pip: command not found"></a>pip: command not found</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用装载模块的方式 使用 pip</span></span><br><span class="line">$ python -m pip --version</span><br><span class="line">  pip 9.0.1 from /root/software/pip-9.0.1 (python 2.7)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改命令别名</span></span><br><span class="line">$ vim ~/.bashrc</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 未生效可直接执行</span></span><br><span class="line">  <span class="built_in">alias</span> pip=<span class="string">'python -m pip'</span></span><br><span class="line"></span><br><span class="line">$ pip --version</span><br><span class="line">  pip 9.0.1 from /root/software/pip-9.0.1 (python 2.7)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="virtualenv-command-not-found"><a href="#virtualenv-command-not-found" class="headerlink" title="virtualenv: command not found"></a>virtualenv: command not found</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ vim ~/.bashrc</span><br><span class="line">  <span class="built_in">alias</span> virtualenv=<span class="string">'python -m virtualenv'</span></span><br><span class="line"></span><br><span class="line">$ virtualenv --version</span><br><span class="line">  15.1.0</span><br></pre></td></tr></tbody></table></figure>
<h3 id="安装-superset-需要下载依赖库"><a href="#安装-superset-需要下载依赖库" class="headerlink" title="安装 superset 需要下载依赖库"></a>安装 superset 需要下载依赖库</h3><h4 id="sasl-sasl-h：没有那个文件或目录"><a href="#sasl-sasl-h：没有那个文件或目录" class="headerlink" title="sasl/sasl.h：没有那个文件或目录"></a>sasl/sasl.h：没有那个文件或目录</h4><h5 id="描述-13"><a href="#描述-13" class="headerlink" title="描述"></a>描述</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gcc: error trying to <span class="built_in">exec</span> <span class="string">'cc1plus'</span>: execvp: 没有那个文件或目录</span><br><span class="line">error: <span class="built_in">command</span> <span class="string">'gcc'</span> failed with <span class="built_in">exit</span> status 1</span><br><span class="line"></span><br><span class="line">cc1plus: 警告：命令行选项 “-Wstrict-prototypes” 对 Ada/C/ObjC 是有效的，但对 C++ 无效</span><br><span class="line">在包含自 sasl/saslwrapper.cpp：254 的文件中:</span><br><span class="line">sasl/saslwrapper.h:22:23: 错误：sasl/sasl.h：没有那个文件或目录</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-15"><a href="#解决-15" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -v</span><br><span class="line">  使用内建 specs。</span><br><span class="line">  目标：x86_64-redhat-linux</span><br><span class="line">  配置为：../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux</span><br><span class="line">  线程模型：posix</span><br><span class="line">  gcc 版本 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装 g++</span></span><br><span class="line"><span class="comment"># g++是c++的编译器，安装好之后，gcc会自动寻找c++程序所需的编译环境，进而编译成功</span></span><br><span class="line"><span class="comment"># wget ftp://rpmfind.net/linux/centos/6.8/os/x86_64/Packages/gcc-c++-4.4.7-17.el6.x86_64.rpm (需要完全一致 gcc 4.4.7-4才行)</span></span><br><span class="line"><span class="comment"># http://rpm.pbone.net/index.php3/stat/4/idpl/25438297/dir/scientific_linux_6/com/gcc-c++-4.4.7-4.el6.x86_64.rpm.html</span></span><br><span class="line"><span class="comment"># http://rpm.pbone.net/index.php3/stat/4/idpl/25440518/dir/scientific_linux_6/com/libstdc++-devel-4.4.7-4.el6.x86_64.rpm.html</span></span><br><span class="line">$ rpm -ivh libstdc++-devel-4.4.7-4.el6.x86_64.rpm</span><br><span class="line">$ rpm -ivh gcc-c++-4.4.7-4.el6.x86_64.rpm</span><br><span class="line"></span><br><span class="line">$ g++ -v</span><br><span class="line">  使用内建 specs。</span><br><span class="line">  目标：x86_64-redhat-linux</span><br><span class="line">  配置为：../configure --prefix=/usr --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=http://bugzilla.redhat.com/bugzilla --enable-bootstrap --enable-shared --enable-threads=posix --enable-checking=release --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-gnu-unique-object --enable-languages=c,c++,objc,obj-c++,java,fortran,ada --enable-java-awt=gtk --disable-dssi --with-java-home=/usr/lib/jvm/java-1.5.0-gcj-1.5.0.0/jre --enable-libgcj-multifile --enable-java-maintainer-mode --with-ecj-jar=/usr/share/java/eclipse-ecj.jar --disable-libjava-multilib --with-ppl --with-cloog --with-tune=generic --with-arch_32=i686 --build=x86_64-redhat-linux</span><br><span class="line">  线程模型：posix</span><br><span class="line">  gcc 版本 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="命令行选项-Wstrict-prototypes-对-Ada-C-ObjC-是有效的，但对-C-无效"><a href="#命令行选项-Wstrict-prototypes-对-Ada-C-ObjC-是有效的，但对-C-无效" class="headerlink" title="命令行选项 -Wstrict-prototypes 对 Ada/C/ObjC 是有效的，但对 C++ 无效"></a>命令行选项 -Wstrict-prototypes 对 Ada/C/ObjC 是有效的，但对 C++ 无效</h4><h5 id="描述-14"><a href="#描述-14" class="headerlink" title="描述"></a>描述</h5><p>　cc1plus: 警告：命令行选项 “-Wstrict-prototypes” 对 Ada/C/ObjC 是有效的，但对 C++ 无效</p>
<h5 id="解决-16"><a href="#解决-16" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cmake 版本过低（这里是没有安装）</span></span><br><span class="line"><span class="comment"># https://cmake.org/ (stable: 3.6.3, lastest: 3.7.1, date: 2016/12/16)</span></span><br><span class="line"><span class="comment"># https://cmake.org/cmake/help/v3.6/</span></span><br><span class="line">$ wget --no-check-certificate  https://cmake.org/files/v3.6/cmake-3.6.3.tar.gz	<span class="comment"># To connect to cmake.org insecurely</span></span><br><span class="line">$ tar zxvf cmake-3.6.3.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> cmake-3.6.3</span><br><span class="line">$ ./bootstrap</span><br><span class="line">$ make</span><br><span class="line">$ gmake install</span><br><span class="line"></span><br><span class="line">$ cmake -version</span><br><span class="line">$ cmake version 3.6.3</span><br><span class="line">$ CMake suite maintained and supported by Kitware (kitware.com/cmake).</span><br><span class="line"></span><br><span class="line"><span class="comment"># reboot (should)</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> ~</span><br><span class="line">$ mkdir virtualenv</span><br><span class="line">$ <span class="built_in">cd</span> virtualenv</span><br><span class="line">$ virtualenv env1</span><br><span class="line">$ virtualenv --python=/usr/bin/python env1</span><br><span class="line"></span><br><span class="line"><span class="comment"># new problem</span></span><br><span class="line"><span class="comment"># IOError: [Errno 40] Too many levels of symbolic links: '/root/virtualenv/env1/bin/python'</span></span><br><span class="line"><span class="comment"># 不能直接 rm -rf env1，需要用 rmvirtualenv 才行</span></span><br><span class="line">$ rmvirtualenv env1</span><br><span class="line">$ <span class="built_in">cd</span> env1</span><br><span class="line">$ <span class="built_in">source</span> bin/activate		   <span class="comment"># 退出 deactivate</span></span><br><span class="line">(env1) [root@edeppreapp01 env1] <span class="comment"># python -V</span></span><br><span class="line">  Python 2.7.12</span><br></pre></td></tr></tbody></table></figure>
<h4 id="Could-not-find-a-version-that-satisfies-the-requirement-pytz-gt-dev"><a href="#Could-not-find-a-version-that-satisfies-the-requirement-pytz-gt-dev" class="headerlink" title="Could not find a version that satisfies the requirement pytz>dev"></a>Could not find a version that satisfies the requirement pytz&gt;dev</h4><h5 id="描述-15"><a href="#描述-15" class="headerlink" title="描述"></a>描述</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果一个一个依赖去安装 会很麻烦</span></span><br><span class="line">Could not find a version that satisfies the requirement pytz&gt;dev (from celery==3.1.23) (from versions: )</span><br><span class="line">Could not find a version that satisfies the requirement billiard&lt;3.4,&gt;=3.3.0.23 (from celery==3.1.23) (from versions: )</span><br><span class="line">No matching distribution found <span class="keyword">for</span> amqp&lt;2.0,&gt;=1.4.9 (from kombu==3.0.35)</span><br><span class="line">No matching distribution found <span class="keyword">for</span> anyjson&gt;=0.3.3 (from kombu==3.0.35)</span><br><span class="line">No matching distribution found <span class="keyword">for</span> kombu&lt;3.1,&gt;=3.0.34 (from celery==3.1.23)</span><br><span class="line">No matching distribution found <span class="keyword">for</span> celery==3.1.23 (from superset)</span><br><span class="line">Could not find suitable distribution <span class="keyword">for</span> Requirement.parse(<span class="string">'werkzeug==0.11.10'</span>)</span><br><span class="line">pip install thrift-0.9.3.tar.gz</span><br><span class="line">No matching distribution found <span class="keyword">for</span> six (from sasl==0.2.1)</span><br><span class="line">No matching distribution found <span class="keyword">for</span> sasl&gt;=0.2.1 (from thrift-sasl==0.2.1)</span><br><span class="line">No <span class="built_in">local</span> packages or working download links found <span class="keyword">for</span> thrift-sasl&gt;=0.2.1</span><br></pre></td></tr></tbody></table></figure>
<h5 id="解决-17"><a href="#解决-17" class="headerlink" title="解决"></a>解决</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ pip list</span><br><span class="line">$ pip freeze &gt; requirements.txt</span><br><span class="line">$ mkdir packages</span><br><span class="line">$ pip install --download package -r requirements.txt</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> packages</span><br><span class="line">$ scp celery-3.1.23-py2.py3-none-any.whl root@druid01:/root/software/packages</span><br><span class="line"></span><br><span class="line"><span class="comment"># --find-links 可以在指定目录中，找到 superset 的相关依赖，依次安装好</span></span><br><span class="line">$ python -m pip install --no-index --find-links=packages superset <span class="comment"># -r requirements.txt</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="ImportError-No-module-named-ssl"><a href="#ImportError-No-module-named-ssl" class="headerlink" title="ImportError: No module named ssl"></a>ImportError: No module named ssl</h3><h4 id="解决-18"><a href="#解决-18" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 ssl</span></span><br><span class="line">$ yum install yum-downloadonly -y</span><br><span class="line"></span><br><span class="line">$ yum -y install ncurses ncurses-devel gcc-c++ libxml2-devel gd gd-devel libpng libpng-devel libjpeg libjpeg-devel libmcrypt libmcrypt-devel openldap-devel openldap-servers openldap-clients autoconf freetype-devel libtool-ltdl-devel openssl openssl-devel gcc automake autoconf libtool make --downloadonly --downloaddir=.</span><br><span class="line"></span><br><span class="line">$ yum -y install GeoIP gmp libevent libmcrypt libtidy libXpm libxslt mhash mysql mysql-server nfs-utils nginx perl-DBD-MySQL perl-DBI php php-common php-fpm php-gd php-mbstring php-mcrypt php-mhash php-mysql php-pdo php-xml t1lib --downloadonly --downloaddir=.</span><br><span class="line"></span><br><span class="line">$ rpm -Uvh --force --nodeps *.rpm</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新编译 Python</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/software/Python-2.7.12</span><br><span class="line">$ vim Modules/Setup.dist</span><br><span class="line"></span><br><span class="line">  <span class="comment"># 取消注释</span></span><br><span class="line">  SSL=/usr/<span class="built_in">local</span>/ssl</span><br><span class="line">  _ssl _ssl.c \</span><br><span class="line">         -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \</span><br><span class="line">         -L$(SSL)/lib -lssl -lcrypto</span><br><span class="line"></span><br><span class="line">$ ./configure --enable-shared CFLAGS=-fPIC //--enable-shared option means to generate dynamic library libpython2.7.so.1.0</span><br><span class="line">make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line"><span class="comment"># Not work</span></span><br><span class="line">$ python --version</span><br><span class="line">  Python 2.7.12</span><br><span class="line"></span><br><span class="line">$ python</span><br><span class="line">Python 2.7.12 (default, Dec 19 2016, 10:58:27) </span><br><span class="line">[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt; Traceback (most recent call last):</span><br><span class="line">&gt;&gt;&gt; File <span class="string">"&lt;stdin&gt;"</span>, line 1, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">&gt;&gt;&gt; File <span class="string">"/usr/local/lib/python2.7/ssl.py"</span>, line 97, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">&gt;&gt;&gt; import _ssl             <span class="comment"># if we can't import it, let the error propagate</span></span><br><span class="line">&gt;&gt;&gt; ImportError: No module named _ssl</span><br><span class="line">&gt;&gt;&gt; quit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 安装缺少的 openssl-devel</span></span><br><span class="line">$ rpm -aq | grep openssl</span><br><span class="line">  openssl-1.0.1e-42.el6_7.4.x86_64</span><br><span class="line"></span><br><span class="line">$ yum install openssl-devel -y</span><br><span class="line"></span><br><span class="line">$ rpm -aq | grep openssl</span><br><span class="line">  openssl-1.0.1e-42.el6_7.4.x86_64</span><br><span class="line">  openssl-devel-1.0.1e-42.el6_7.4.x86_64</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改 Setup 文件</span></span><br><span class="line">$ vim /root/software/Python-2.7.12/Modules/Setup</span><br><span class="line">  <span class="comment"># Socket module helper for socket(2)</span></span><br><span class="line">  _socket socketmodule.c timemodule.c</span><br><span class="line"></span><br><span class="line">  <span class="comment"># Socket module helper for SSL support; you must comment out the other</span></span><br><span class="line">  <span class="comment"># socket line above, and possibly edit the SSL variable:</span></span><br><span class="line">  <span class="comment">#SSL=/usr/local/ssl</span></span><br><span class="line">  _ssl _ssl.c \</span><br><span class="line">  -DUSE_SSL -I$(SSL)/include -I$(SSL)/include/openssl \</span><br><span class="line">  -L$(SSL)/lib -lssl -lcrypto</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新编译</span></span><br><span class="line">$ <span class="built_in">cd</span> /root/software/Python-2.7.12</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line"></span><br><span class="line">$ python</span><br><span class="line">Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /root/virtualenv/superset/bin</span><br><span class="line">[root@olap03-sit bin]<span class="comment"># python</span></span><br><span class="line">Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line"></span><br><span class="line">$ /root/virtualenv/superset/bin/python</span><br><span class="line">Python 2.7.12 (default, Dec 16 2016, 16:23:17) </span><br><span class="line">[GCC 4.4.6 20120305 (Red Hat 4.4.6-4)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt; Traceback (most recent call last):</span><br><span class="line">&gt;&gt;&gt; File <span class="string">"&lt;stdin&gt;"</span>, line 1, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">&gt;&gt;&gt; File <span class="string">"/usr/local/python27/lib/python2.7/ssl.py"</span>, line 97, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">&gt;&gt;&gt; import _ssl             <span class="comment"># if we can't import it, let the error propagate</span></span><br><span class="line">&gt;&gt;&gt; ImportError: No module named _ssl</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ mv /root/virtualenv/superset/bin/python /root/virtualenv/superset/bin/python_old</span><br><span class="line">$ ln -s /usr/<span class="built_in">local</span>/bin/python /root/virtualenv/superset/bin/</span><br><span class="line"></span><br><span class="line">$ ./python</span><br><span class="line">Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">[GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt; quit()</span><br><span class="line">&gt;&gt;&gt; [root@olap03-sit bin]<span class="comment"># </span></span><br><span class="line">&gt;&gt;&gt; [root@olap03-sit bin]<span class="comment"># </span></span><br><span class="line">&gt;&gt;&gt; [root@olap03-sit bin]<span class="comment"># pwd</span></span><br><span class="line">&gt;&gt;&gt; /root/virtualenv/superset/bin</span><br><span class="line">&gt;&gt;&gt; [root@olap03-sit bin]<span class="comment"># /root/virtualenv/superset/bin/python</span></span><br><span class="line">&gt;&gt;&gt; Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">&gt;&gt;&gt; [GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">&gt;&gt;&gt; Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt; quit()</span><br><span class="line">&gt;&gt;&gt; [root@olap03-sit bin]<span class="comment"># python</span></span><br><span class="line">&gt;&gt;&gt; Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">&gt;&gt;&gt; [GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">&gt;&gt;&gt; Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt;</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">source</span> bin/activate</span><br><span class="line">&gt;&gt;&gt; (superset) [root@olap03-sit superset]<span class="comment"># which python</span></span><br><span class="line">&gt;&gt;&gt; /root/virtualenv/superset/bin/python</span><br><span class="line">&gt;&gt;&gt; (superset) [root@olap03-sit superset]<span class="comment"># python</span></span><br><span class="line">&gt;&gt;&gt; Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">&gt;&gt;&gt; [GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">&gt;&gt;&gt; Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; import ssl</span><br><span class="line">&gt;&gt;&gt; quit()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ImportError: No module named gunicorn.app.base</span></span><br><span class="line">import gunicorn.app.base</span><br></pre></td></tr></tbody></table></figure>
<h3 id="python-error-while-loading-shared-libraries-libpython2-7-so-1-0"><a href="#python-error-while-loading-shared-libraries-libpython2-7-so-1-0" class="headerlink" title="python: error while loading shared libraries: libpython2.7.so.1.0"></a>python: error while loading shared libraries: libpython2.7.so.1.0</h3><h4 id="描述-16"><a href="#描述-16" class="headerlink" title="描述"></a>描述</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ ./configure --prefix=/usr/<span class="built_in">local</span>/python27 --enable-shared CFLAGS=-fPIC //--enable-shared option means to generate dynamic library libpython2.7.so.1.0</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ python -V</span><br><span class="line">  python: error <span class="keyword">while</span> loading shared libraries: libpython2.7.so.1.0: cannot open shared object file: No such file or directory</span><br></pre></td></tr></tbody></table></figure>
<h4 id="解决-19"><a href="#解决-19" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">$ yum reinstall python-libs		--not work</span><br><span class="line"></span><br><span class="line">$ ll /usr/<span class="built_in">local</span>/python27/lib/libpython2.7.so.1.0		--not work</span><br><span class="line">$ vim /etc/ld.so.conf</span><br><span class="line">  include ld.so.conf.d/*.conf</span><br><span class="line">  include /usr/<span class="built_in">local</span>/Python2.7/lib</span><br><span class="line"></span><br><span class="line">$ /sbin/ldconfig -v | grep /</span><br><span class="line">  /lib:</span><br><span class="line">  /lib64:</span><br><span class="line">  /usr/lib:</span><br><span class="line">  /usr/lib64:</span><br><span class="line">  /lib64/tls: (hwcap: 0x8000000000000000)</span><br><span class="line">  /usr/lib64/sse2: (hwcap: 0x0000000004000000)</span><br><span class="line">  /usr/lib64/tls: (hwcap: 0x8000000000000000)</span><br><span class="line"></span><br><span class="line">$ ./configure --prefix=/usr --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ /sbin/ldconfig -v | grep /</span><br><span class="line">$ python -V</span><br><span class="line">  Python 2.7.12</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ImportError-No-module-named-pysqlite2"><a href="#ImportError-No-module-named-pysqlite2" class="headerlink" title="ImportError: No module named pysqlite2"></a>ImportError: No module named pysqlite2</h3><h4 id="解决-20"><a href="#解决-20" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ vim /root/superset/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/pysqlite.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改 sqlite3</span></span><br><span class="line">@classmethod</span><br><span class="line">def dbapi(cls):</span><br><span class="line">try:</span><br><span class="line">  <span class="comment"># 改为 from sqlite3 import dbapi2 as sqlite</span></span><br><span class="line">  from pysqlite2 import dbapi2 as sqlite</span><br><span class="line">except ImportError as e:</span><br><span class="line">  try:</span><br><span class="line">    from sqlite3 import dbapi2 as sqlite  <span class="comment"># try 2.5+ stdlib name.</span></span><br><span class="line">  except ImportError:</span><br><span class="line">    raise e</span><br><span class="line"><span class="built_in">return</span> sqlite</span><br><span class="line"></span><br><span class="line"><span class="comment"># Redhat 5.3 环境下，要源代码安装 sqlite3，然后安装 python 才能有 _sqlite3.so 这个文件</span></span><br><span class="line">$ wget https://sqlite.org/snapshot/sqlite-snapshot-201612131847.tar.gz</span><br><span class="line">$ sqlite3 --version</span><br><span class="line">  3.6.20</span><br></pre></td></tr></tbody></table></figure>
<h3 id="pip-is-configured-with-locations-that-require-TLS-SSL-however-the-ssl-module-in-Python-is-not-available"><a href="#pip-is-configured-with-locations-that-require-TLS-SSL-however-the-ssl-module-in-Python-is-not-available" class="headerlink" title="pip is configured with locations that require TLS/SSL, however the ssl module in Python is not available."></a>pip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.</h3><h4 id="解决-21"><a href="#解决-21" class="headerlink" title="解决"></a>解决</h4><h5 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清除所有的 alias 和 superset 源码中 python 路径的修改</span></span><br><span class="line">$ <span class="built_in">which</span> pip</span><br><span class="line">$ <span class="built_in">alias</span> pip=<span class="string">'python -m pip'</span></span><br><span class="line">$ /root/superset/bin/python</span><br><span class="line"></span><br><span class="line">$ vim ~/.bashrc</span><br><span class="line"><span class="comment"># alias pip='python -m pip'</span></span><br><span class="line"><span class="comment"># alias virtualenv='python -m virtualenv'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Source global definitions</span></span><br><span class="line"><span class="comment"># export WORKON_HOME=~/virtualenv</span></span><br><span class="line"><span class="comment"># source /usr/local/bin/virtualenvwrapper.sh</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc</span><br><span class="line">$ deactivate</span><br><span class="line">$ yum install python-pip</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">unalias</span> pip</span><br><span class="line">$ <span class="built_in">which</span> pip</span><br><span class="line">$ /usr/bin/pip</span><br><span class="line"></span><br><span class="line">$ superset runserver -a 0.0.0.0 -p 9999</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">cd</span> /usr/<span class="built_in">local</span>/lib/python2.7/site-packages</span><br><span class="line"></span><br><span class="line">$ python</span><br><span class="line">  Python 2.7.12 (default, Dec 19 2016, 11:08:33) </span><br><span class="line">  [GCC 4.4.7 20120313 (Red Hat 4.4.7-4)] on linux2</span><br><span class="line">  Type <span class="string">"help"</span>, <span class="string">"copyright"</span>, <span class="string">"credits"</span> or <span class="string">"license"</span> <span class="keyword">for</span> more information.</span><br><span class="line">  &gt;&gt;&gt; import ssl</span><br><span class="line">  &gt;&gt;&gt; ssl</span><br><span class="line">  &lt;module <span class="string">'ssl'</span> from <span class="string">'/usr/local/lib/python2.7/ssl.pyc'</span>&gt;</span><br><span class="line">  &gt;&gt;&gt; quit()</span><br><span class="line"></span><br><span class="line">$ vim mypkpath.pth</span><br><span class="line">  /usr/<span class="built_in">local</span>/lib/python2.7</span><br><span class="line"></span><br><span class="line">$ vim ~/.bashrc</span><br><span class="line">  <span class="built_in">alias</span> python=/usr/<span class="built_in">local</span>/bin/python</span><br><span class="line">  <span class="built_in">alias</span> pip=/usr/bin/pip</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">source</span> ~/.bashrc		--not work（superset 的 py程序开头都有 <span class="comment">#!/root/superset/bin/python）</span></span><br><span class="line">$ vim /root/superset/bin/superset</span><br><span class="line">  <span class="comment">#!/usr/local/bin/python</span></span><br></pre></td></tr></tbody></table></figure>
<h5 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h5><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用 prefix 将 python 的第三方库安装到 /usr/lib 中</span></span><br><span class="line">$ ./configure --prefix=/usr --enable-shared CFLAGS=-fPIC</span><br><span class="line">$ make &amp;&amp; make install</span><br><span class="line">$ /sbin/ldconfig -v | grep /</span><br><span class="line">$ python -V</span><br><span class="line">  Python 2.7.12</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Error-while-processing-cluster-‘druid-cluster’-sqlite3-Operational-Error-database-is-locked"><a href="#Error-while-processing-cluster-‘druid-cluster’-sqlite3-Operational-Error-database-is-locked" class="headerlink" title="Error while processing cluster ‘druid cluster’ (sqlite3. Operational Error) database is locked"></a>Error while processing cluster ‘druid cluster’ (sqlite3. Operational Error) database is locked</h3><h4 id="描述-17"><a href="#描述-17" class="headerlink" title="描述"></a>描述</h4><p>　[Web UI] Sources - Druid Clusters 配置 - Refresh Druid Metadata</p>
<h4 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h4><p>　Web 中无法维持长连接，会超时</p>
<h4 id="解决-22"><a href="#解决-22" class="headerlink" title="解决"></a>解决</h4><p>　superset refresh_druid</p>
<p>Tips: 目前最新的 v0.22.1 版本中，已经解决了这个问题，可以在页面上直接点击 “Sources - Refresh Druid Metadata” 按钮，完成操作（2017-12-12）</p>
<h3 id="An-unknown-error-occurred-Status-0-Maybe-the-request-timed-out"><a href="#An-unknown-error-occurred-Status-0-Maybe-the-request-timed-out" class="headerlink" title="An unknown error occurred. (Status: 0) Maybe the request timed out?"></a>An unknown error occurred. (Status: 0) Maybe the request timed out?</h3><h4 id="描述-18"><a href="#描述-18" class="headerlink" title="描述"></a>描述</h4><p>　部分图标 无法正常显示</p>
<h4 id="解决-23"><a href="#解决-23" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开 debug 模式，查看详细日志，定位问题</span></span><br><span class="line">$ vim ./lib/python2.7/site-packages/superset/config.py</span><br><span class="line"></span><br><span class="line">  <span class="comment"># DEBUG = False</span></span><br><span class="line">  DEBUG = True</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ImportError-No-module-named-pymysql"><a href="#ImportError-No-module-named-pymysql" class="headerlink" title="ImportError: No module named pymysql"></a>ImportError: No module named pymysql</h3><h4 id="解决-24"><a href="#解决-24" class="headerlink" title="解决"></a>解决</h4><p>　<code>pip install pymysql</code></p>
<h3 id="uHost-druid01-is-not-allowed-to-connect-to-this-MySQL-server"><a href="#uHost-druid01-is-not-allowed-to-connect-to-this-MySQL-server" class="headerlink" title="uHost druid01 is not allowed to connect to this MySQL server"></a>uHost druid01 is not allowed to connect to this MySQL server</h3><h4 id="描述-19"><a href="#描述-19" class="headerlink" title="描述"></a>描述</h4><p>　nohup superset runserver -a 0.0.0.0 -p 8888 2&gt;&amp;1 &amp;</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2017-01-22 16:36:53,013:ERROR:flask_appbuilder.security.sqla.manager:DB Creation and initialization failed: (pymysql.err.InternalError) (1130, u<span class="string">"Host 'druid01' is not allowed to connect to this MySQL server"</span>)</span><br></pre></td></tr></tbody></table></figure>
<h4 id="解决-25"><a href="#解决-25" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRANT ALL PRIVILEGES ON *.* TO <span class="string">'root'</span>@<span class="string">'druid01'</span> IDENTIFIED BY <span class="string">'root'</span> WITH GRANT OPTION;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Permission-for-Druid"><a href="#Permission-for-Druid" class="headerlink" title="Permission for Druid"></a>Permission for Druid</h3><h4 id="解决-26"><a href="#解决-26" class="headerlink" title="解决"></a>解决</h4><p>　增加新的数据源之后，需要 <code>superset init</code>，来更新 permission 相关的数据表</p>
<h3 id="Update-Druid-Cluster’s-Name"><a href="#Update-Druid-Cluster’s-Name" class="headerlink" title="Update Druid Cluster’s Name"></a>Update Druid Cluster’s Name</h3><h4 id="解决-27"><a href="#解决-27" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">alter table datasources drop FOREIGN KEY `datasources_ibfk_2`;</span><br><span class="line">update clusters <span class="built_in">set</span> cluster_name=<span class="string">'Druid Cluster'</span> <span class="built_in">where</span> cluster_name=<span class="string">'druid cluster'</span>;</span><br><span class="line">update datasources <span class="built_in">set</span> cluster_name =<span class="string">'Druid Cluster'</span> <span class="built_in">where</span> cluster_name =<span class="string">'druid cluster'</span>;</span><br><span class="line">alter table datasources add constraint  `datasources_ibfk_2`  FOREIGN KEY (`cluster_name`) REFERENCES `clusters` (`cluster_name`);</span><br><span class="line"><span class="comment"># show create table datasources; # troubleshooting</span></span><br></pre></td></tr></tbody></table></figure>
<h3 id="An-unexpected-error-occurred-“https-registry-yarnpkg-com-convert-source-map-ETIMEDOUT”"><a href="#An-unexpected-error-occurred-“https-registry-yarnpkg-com-convert-source-map-ETIMEDOUT”" class="headerlink" title="An unexpected error occurred: “https://registry.yarnpkg.com/convert-source-map: ETIMEDOUT”"></a>An unexpected error occurred: “<a target="_blank" rel="external nofollow noopener noreferrer" href="https://registry.yarnpkg.com/convert-source-map">https://registry.yarnpkg.com/convert-source-map</a>: ETIMEDOUT”</h3><h4 id="描述-20"><a href="#描述-20" class="headerlink" title="描述"></a>描述</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ yarn</span><br><span class="line">  yarn install v1.3.2</span><br><span class="line">  info No lockfile found.</span><br><span class="line">  [1/4] Resolving packages...</span><br><span class="line">  error An unexpected error occurred: <span class="string">"https://registry.yarnpkg.com/@vx%2fbounds: ETIMEDOUT"</span>.</span><br><span class="line">  info If you think this is a bug, please open a bug report with the information provided <span class="keyword">in</span> <span class="string">"/home/superset/software/incubator-superset-0.22.1/superset/assets/yarn-error.log"</span>.</span><br><span class="line">  info Visit https://yarnpkg.com/en/docs/cli/install <span class="keyword">for</span> documentation about this <span class="built_in">command</span>.</span><br></pre></td></tr></tbody></table></figure>
<h4 id="解决-28"><a href="#解决-28" class="headerlink" title="解决"></a>解决</h4><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于不知名的外星力量，需要先替换掉原始的 IP 地址</span></span><br><span class="line">$ vim /etc/hosts</span><br><span class="line">  104.16.59.173 registry.yarnpkg.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 控制网络并发量，减少 TIMEOUT 发生的可能</span></span><br><span class="line">$ yarn --network-concurrency 1</span><br></pre></td></tr></tbody></table></figure>
<h2 id="社区跟进"><a href="#社区跟进" class="headerlink" title="社区跟进"></a>社区跟进</h2><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/issues?utf8=%E2%9C%93&amp;q=%20is%3Aissue%20author%3Aasdf2014%20">Issues</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/apache/superset/pulls?utf8=%E2%9C%93&amp;q=%20is%3Apr%20author%3Aasdf2014%20">Pull Request</a></li>
</ul>
<p>　详见：《<a href="https://yuzhouwan.com/posts/19631/">如何成为 Apache 的 PMC</a>》</p>
<h2 id="资料"><a href="#资料" class="headerlink" title="资料"></a>资料</h2><h3 id="Doc"><a href="#Doc" class="headerlink" title="Doc"></a>Doc</h3><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://superset.apache.org/installation.html#getting-started">Superset Doc</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://docs.gunicorn.org/en/stable/install.html">Gunicorn Doc</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://docs.jinkan.org/docs/flask/">Flask Doc</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://jinja.pocoo.org/docs/2.9/">Jinja Doc</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.djangoproject.com/">Django Doc</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://pythonhosted.org/pydruid/">Welcome to pydruid´s documentation!</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://pandas.pydata.org/">Python Data Analysis Library</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://www.scipy.org/stackspec.html">The SciPy Stack specification</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://scikit-learn.org/stable/">Scikit-learn</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://pandas.pydata.org">Pandas Doc</a></li>
</ul>
<h3 id="Book"><a href="#Book" class="headerlink" title="Book"></a>Book</h3><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://spacewander.github.io/explore-flask-zh/index.html">《Flask之旅》</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://es6.ruanyifeng.com/">《ECMAScript 6 入门》</a></li>
</ul>
<h3 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h3><ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/druid-io/pydruid#pydruid">pydruid (A Python connector for Druid)</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://rpmfind.net/">rpmfind.net</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="http://rpm.pbone.net/">rpm.pbone.net</a>  （better, download with <code>mirror.switch.ch</code>）</li>
</ul>
<h2 id="欢迎加入我们的技术群，一起交流学习"><a href="#欢迎加入我们的技术群，一起交流学习" class="headerlink" title="欢迎加入我们的技术群，一起交流学习"></a><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/asdf2014/yuzhouwan#technical-discussion-group">欢迎加入我们的技术群，一起交流学习</a></h2><div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center">群名称</th>
<th style="text-align:center">群号</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">人工智能（高级）</td>
<td style="text-align:center"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://shang.qq.com/wpa/qunwpa?idkey=71c6bd3fb0ff01d93abca654140387d99d3be752f92a53c1fbfd27f2dd4b4247"><img data-src="https://img.shields.io/badge/QQ%E7%BE%A4-1020982-blue.svg" alt></a></td>
</tr>
<tr>
<td style="text-align:center">人工智能（进阶）</td>
<td style="text-align:center"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://shang.qq.com/wpa/qunwpa?idkey=deb268f65589a1a0a1dbaf7b72c849ed45298697805bef81e0c613dea40cd05e"><img data-src="https://img.shields.io/badge/QQ%E7%BE%A4-1217710-blue.svg" alt></a></td>
</tr>
<tr>
<td style="text-align:center">BigData</td>
<td style="text-align:center"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://shang.qq.com/wpa/qunwpa?idkey=f86b3c8de20da1658a3bb42df17a2fc4eee0d75c4a130a63585fdd257e3565ed"><img data-src="https://img.shields.io/badge/QQ%E7%BE%A4-1670647-blue.svg" alt></a></td>
</tr>
<tr>
<td style="text-align:center">算法</td>
<td style="text-align:center"><a target="_blank" rel="external nofollow noopener noreferrer" href="https://shang.qq.com/wpa/qunwpa?idkey=bfbcf1453371a0810fd6be235ace47147f6fb9d262fb768b497c861f50af0af4"><img data-src="https://img.shields.io/badge/QQ%E7%BE%A4-5366753-blue.svg" alt></a></td>
</tr>
</tbody>
</table>
</div>

    </div>

    
    
    
      
  <div class="popular-posts-header">相关文章</div>
  <ul class="popular-posts">
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/5845/" rel="bookmark">Apache Druid：一款高效的 OLAP 引擎</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/19631/" rel="bookmark">如何成为 Apache 的 PMC</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/200906/" rel="bookmark">Presto：分布式 SQL 查询引擎</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/26002/" rel="bookmark">Apache Kafka 分布式消息队列框架</a></div>
    </li>
    <li class="popular-posts-item">
      <div class="popular-posts-title"><a href="/posts/43687/" rel="bookmark">Python：从入门到实践</a></div>
    </li>
  </ul>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>Benedict Jin
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://yuzhouwan.com/posts/743/" title="Apache Superset 二次开发">https://yuzhouwan.com/posts/743/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-ND</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/wechat_channel.jpg">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Apache-Druid/" rel="tag"># Apache Druid</a>
              <a href="/tags/Apache-Superset/" rel="tag"># Apache Superset</a>
              <a href="/tags/Python/" rel="tag"># Python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/posts/19631/" rel="prev" title="如何成为 Apache 的 PMC">
      <i class="fa fa-chevron-left"></i> 如何成为 Apache 的 PMC
    </a></div>
      <div class="post-nav-item">
    <a href="/posts/39683/" rel="next" title="Apache Eagle 深度调研">
      Apache Eagle 深度调研 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
      <div class="tabs tabs-comment">
        <ul class="nav-tabs">
            <li class="tab"><a href="#comment-gitalk">Gitalk：可用 Github 账号登录</a></li>
            <li class="tab"><a href="#comment-disqus">Disqus：海外</a></li>
            <li class="tab"><a href="#comment-valine">Valine：匿名</a></li>
        </ul>
        <div class="tab-content">
            <div class="tab-pane gitalk" id="comment-gitalk">
              <div class="comments" id="gitalk-container"></div>
            </div>
            <div class="tab-pane disqus" id="comment-disqus">
              
  <div class="comments">
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
  </div>
  
            </div>
            <div class="tab-pane valine" id="comment-valine">
              <div class="comments" id="valine-comments"></div>
            </div>
        </div>
      </div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Apache-Superset-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.</span> <span class="nav-text">Apache Superset 是什么？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%BB%84%E4%BB%B6"><span class="nav-number">2.</span> <span class="nav-text">基础组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Flask"><span class="nav-number">2.1.</span> <span class="nav-text">Flask</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Gunicorn"><span class="nav-number">2.2.</span> <span class="nav-text">Gunicorn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#WSGI"><span class="nav-number">2.2.1.</span> <span class="nav-text">WSGI</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pre-Fork"><span class="nav-number">2.2.2.</span> <span class="nav-text">Pre-Fork</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Django"><span class="nav-number">2.3.</span> <span class="nav-text">Django</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PyDruid"><span class="nav-number">2.4.</span> <span class="nav-text">PyDruid</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pandas"><span class="nav-number">2.5.</span> <span class="nav-text">Pandas</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SciPy"><span class="nav-number">2.6.</span> <span class="nav-text">SciPy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Scikit-learn"><span class="nav-number">2.7.</span> <span class="nav-text">Scikit-learn</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#D3-js"><span class="nav-number">2.8.</span> <span class="nav-text">D3.js</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%89%E8%A3%85"><span class="nav-number">3.</span> <span class="nav-text">安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%8E%AF%E5%A2%83"><span class="nav-number">3.1.</span> <span class="nav-text">基础环境</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#OS"><span class="nav-number">3.1.1.</span> <span class="nav-text">OS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Machines"><span class="nav-number">3.1.2.</span> <span class="nav-text">Machines</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python-%E7%9B%B8%E5%85%B3"><span class="nav-number">3.2.</span> <span class="nav-text">Python 相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Python"><span class="nav-number">3.2.1.</span> <span class="nav-text">Python</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pip"><span class="nav-number">3.2.2.</span> <span class="nav-text">Pip</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Virtualenv"><span class="nav-number">3.2.3.</span> <span class="nav-text">Virtualenv</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Superset-%E7%9B%B8%E5%85%B3"><span class="nav-number">3.3.</span> <span class="nav-text">Superset 相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Superset-%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-number">3.3.1.</span> <span class="nav-text">Superset 初始化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Virtualenv-%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4"><span class="nav-number">3.3.2.</span> <span class="nav-text">Virtualenv 工作空间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VirtualenvWrapper"><span class="nav-number">3.3.3.</span> <span class="nav-text">VirtualenvWrapper</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%83%A8%E7%BD%B2%E4%B8%8A%E7%BA%BF"><span class="nav-number">3.4.</span> <span class="nav-text">部署上线</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%B7%E8%B4%9D"><span class="nav-number">3.4.1.</span> <span class="nav-text">拷贝</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E9%93%BE%E6%8E%A5%E5%BA%93"><span class="nav-number">3.4.2.</span> <span class="nav-text">动态链接库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="nav-number">3.4.3.</span> <span class="nav-text">用户权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8"><span class="nav-number">3.4.4.</span> <span class="nav-text">元数据存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8"><span class="nav-number">3.4.5.</span> <span class="nav-text">启动</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0%E8%BF%90%E8%A1%8C"><span class="nav-number">4.</span> <span class="nav-text">本地运行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96"><span class="nav-number">4.1.</span> <span class="nav-text">依赖</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows-%E7%9B%B8%E5%85%B3"><span class="nav-number">4.1.1.</span> <span class="nav-text">Windows 相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Microsoft-Visual-C-9-0-is-required-Unable-to-find-vcvarsall-bat"><span class="nav-number">4.1.1.1.</span> <span class="nav-text">Microsoft Visual C++ 9.0 is required (Unable to find vcvarsall.bat)</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0"><span class="nav-number">4.1.1.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3"><span class="nav-number">4.1.1.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%80%98openssl-opensslv-h%E2%80%99-No-such-file-or-directory"><span class="nav-number">4.1.1.2.</span> <span class="nav-text">‘openssl&#x2F;opensslv.h’: No such file or directory</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-1"><span class="nav-number">4.1.1.2.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Cannot-open-include-file-%E2%80%98stdint-h%E2%80%99-No-such-file-or-directory"><span class="nav-number">4.1.1.3.</span> <span class="nav-text">Cannot open include file: ‘stdint.h’: No such file or directory</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-2"><span class="nav-number">4.1.1.3.1.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Python%E7%9B%B8%E5%85%B3"><span class="nav-number">4.1.2.</span> <span class="nav-text">Python相关</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Make-sure-that-you-use-the-correct-version-of-%E2%80%98pip%E2%80%99"><span class="nav-number">4.1.2.1.</span> <span class="nav-text">Make sure that you use the correct version of ‘pip’</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-1"><span class="nav-number">4.1.2.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-3"><span class="nav-number">4.1.2.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E2%80%98Connection-to-pypi-python-org-timed-out-connect-timeout-15-%E2%80%99"><span class="nav-number">4.1.2.2.</span> <span class="nav-text">‘Connection to pypi.python.org timed out. (connect timeout&#x3D;15)’</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-2"><span class="nav-number">4.1.2.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-4"><span class="nav-number">4.1.2.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#setup-py-failed-with-error-code-1"><span class="nav-number">4.1.2.3.</span> <span class="nav-text">setup.py failed with error code 1</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-3"><span class="nav-number">4.1.2.3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-5"><span class="nav-number">4.1.2.3.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E-K8S-%E7%8E%AF%E5%A2%83%E9%83%A8%E7%BD%B2"><span class="nav-number">5.</span> <span class="nav-text">基于 K8S 环境部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="nav-number">6.</span> <span class="nav-text">开发环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BE%9D%E8%B5%96-1"><span class="nav-number">6.1.</span> <span class="nav-text">依赖</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%99%9A%E6%8B%9F%E7%8E%AF%E5%A2%83"><span class="nav-number">6.2.</span> <span class="nav-text">虚拟环境</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="nav-number">6.3.</span> <span class="nav-text">代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-1"><span class="nav-number">6.4.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Npm"><span class="nav-number">6.5.</span> <span class="nav-text">Npm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">6.6.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IDE-%E4%B8%AD%E8%BF%9C%E7%A8%8B%E5%BC%80%E5%8F%91"><span class="nav-number">6.7.</span> <span class="nav-text">IDE 中远程开发</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Remote-Debug"><span class="nav-number">6.7.1.</span> <span class="nav-text">Remote Debug</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E6%AC%A1%E5%BC%80%E5%8F%91"><span class="nav-number">7.</span> <span class="nav-text">二次开发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Others-Category"><span class="nav-number">7.1.</span> <span class="nav-text">Others Category</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-4"><span class="nav-number">7.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-6"><span class="nav-number">7.1.2.</span> <span class="nav-text">解决</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0-row-limit-%E5%8F%AF%E4%BB%A5%E6%8E%92%E9%99%A4-topN-%E4%B9%8B%E5%A4%96%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">7.1.2.1.</span> <span class="nav-text">增加 row_limit 可以排除 topN 之外的数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#others-category-%E5%B0%86-topN-%E4%B9%8B%E5%A4%96%E7%9A%84%E6%95%B0%E6%8D%AE%E8%81%9A%E5%90%88"><span class="nav-number">7.1.2.2.</span> <span class="nav-text">others_category 将 topN 之外的数据聚合</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Y-%E8%BD%B4%E6%95%B0%E6%8D%AE%E5%BC%82%E5%B8%B8"><span class="nav-number">7.2.</span> <span class="nav-text">Y 轴数据异常</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-5"><span class="nav-number">7.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-7"><span class="nav-number">7.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%8E%E6%9C%9F%E4%BC%98%E5%8C%96"><span class="nav-number">8.</span> <span class="nav-text">后期优化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#MySQL-%E6%97%B6%E5%8C%BA%E9%97%AE%E9%A2%98"><span class="nav-number">8.1.</span> <span class="nav-text">MySQL 时区问题</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2"><span class="nav-number">8.1.1.</span> <span class="nav-text">查询</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-6"><span class="nav-number">8.1.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-8"><span class="nav-number">8.1.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%95%E7%A4%BA"><span class="nav-number">8.1.2.</span> <span class="nav-text">展示</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-7"><span class="nav-number">8.1.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-9"><span class="nav-number">8.1.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Superset-%E5%8D%87%E7%BA%A7"><span class="nav-number">8.2.</span> <span class="nav-text">Superset 升级</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Unknown-column-%E2%80%98datasources-filter-select-enabled%E2%80%99-in-%E2%80%98field-list%E2%80%99"><span class="nav-number">8.2.1.</span> <span class="nav-text">Unknown column ‘datasources.filter_select_enabled’ in ‘field list’</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-8"><span class="nav-number">8.2.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-10"><span class="nav-number">8.2.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Issues-with-Druid-timezones"><span class="nav-number">8.2.2.</span> <span class="nav-text">Issues with Druid timezones</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-9"><span class="nav-number">8.2.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-11"><span class="nav-number">8.2.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pydevd-%E6%97%A0%E6%B3%95%E8%BF%9B%E8%A1%8C-remote-debug"><span class="nav-number">8.2.3.</span> <span class="nav-text">pydevd 无法进行 remote debug</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-10"><span class="nav-number">8.2.3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-12"><span class="nav-number">8.2.3.2.</span> <span class="nav-text">解决</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E7%94%A8-cli-py-%E5%90%AF%E5%8A%A8-%E2%80%94not-ok"><span class="nav-number">8.2.3.2.1.</span> <span class="nav-text">直接用 cli.py 启动    —not ok</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95%E8%A7%A3%E5%86%B3-WARNING-werkzeug-Debugger-is-active-%E9%97%AE%E9%A2%98"><span class="nav-number">8.2.3.2.2.</span> <span class="nav-text">尝试解决 WARNING:werkzeug: * Debugger is active! 问题</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sqlite3-%E5%88%87%E6%8D%A2%E4%B8%BA-MySQL"><span class="nav-number">8.3.</span> <span class="nav-text">Sqlite3 切换为 MySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B0%9D%E8%AF%95-SQLite-%E8%87%AA%E5%B8%A6%E7%9A%84-dump-%E5%91%BD%E4%BB%A4"><span class="nav-number">8.3.1.</span> <span class="nav-text">尝试 SQLite 自带的 dump 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%87%AA%E5%B7%B1%E5%AE%9E%E7%8E%B0-sqlite3tomysql-py"><span class="nav-number">8.3.2.</span> <span class="nav-text">自己实现 sqlite3tomysql.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%83%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8-1"><span class="nav-number">8.3.3.</span> <span class="nav-text">元数据存储</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8-1"><span class="nav-number">8.3.4.</span> <span class="nav-text">启动</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%B0%83%E4%BC%98"><span class="nav-number">8.4.</span> <span class="nav-text">参数调优</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E5%BF%97"><span class="nav-number">8.5.</span> <span class="nav-text">日志</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ExtDeprecationWarning-Importing-flask-ext-cache-is-deprecated-use-flask-cache-instead"><span class="nav-number">8.5.1.</span> <span class="nav-text">ExtDeprecationWarning: Importing flask.ext.cache is deprecated, use flask_cache instead.</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-11"><span class="nav-number">8.5.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-13"><span class="nav-number">8.5.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91"><span class="nav-number">9.</span> <span class="nav-text">遇到的坑</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA-user-%E6%97%B6%EF%BC%8C%E9%9C%80%E4%BF%9D%E8%AF%81-email-%E7%9A%84%E5%94%AF%E4%B8%80%E6%80%A7"><span class="nav-number">9.1.</span> <span class="nav-text">创建 user 时，需保证 email 的唯一性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E5%B0%91%E7%9A%84%E4%BE%9D%E8%B5%96%E5%8C%85"><span class="nav-number">9.2.</span> <span class="nav-text">缺少的依赖包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-12"><span class="nav-number">9.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-14"><span class="nav-number">9.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Python-%E6%97%A0%E6%B3%95%E8%A3%85%E8%BD%BD%E6%A8%A1%E5%9D%97%EF%BC%88RedHat-Problem%EF%BC%89"><span class="nav-number">9.3.</span> <span class="nav-text">Python 无法装载模块（RedHat Problem）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#pip-command-not-found"><span class="nav-number">9.3.1.</span> <span class="nav-text">pip: command not found</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#virtualenv-command-not-found"><span class="nav-number">9.3.2.</span> <span class="nav-text">virtualenv: command not found</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%89%E8%A3%85-superset-%E9%9C%80%E8%A6%81%E4%B8%8B%E8%BD%BD%E4%BE%9D%E8%B5%96%E5%BA%93"><span class="nav-number">9.4.</span> <span class="nav-text">安装 superset 需要下载依赖库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#sasl-sasl-h%EF%BC%9A%E6%B2%A1%E6%9C%89%E9%82%A3%E4%B8%AA%E6%96%87%E4%BB%B6%E6%88%96%E7%9B%AE%E5%BD%95"><span class="nav-number">9.4.1.</span> <span class="nav-text">sasl&#x2F;sasl.h：没有那个文件或目录</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-13"><span class="nav-number">9.4.1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-15"><span class="nav-number">9.4.1.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%80%89%E9%A1%B9-Wstrict-prototypes-%E5%AF%B9-Ada-C-ObjC-%E6%98%AF%E6%9C%89%E6%95%88%E7%9A%84%EF%BC%8C%E4%BD%86%E5%AF%B9-C-%E6%97%A0%E6%95%88"><span class="nav-number">9.4.2.</span> <span class="nav-text">命令行选项 -Wstrict-prototypes 对 Ada&#x2F;C&#x2F;ObjC 是有效的，但对 C++ 无效</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-14"><span class="nav-number">9.4.2.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-16"><span class="nav-number">9.4.2.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Could-not-find-a-version-that-satisfies-the-requirement-pytz-gt-dev"><span class="nav-number">9.4.3.</span> <span class="nav-text">Could not find a version that satisfies the requirement pytz&gt;dev</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-15"><span class="nav-number">9.4.3.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-17"><span class="nav-number">9.4.3.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ImportError-No-module-named-ssl"><span class="nav-number">9.5.</span> <span class="nav-text">ImportError: No module named ssl</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-18"><span class="nav-number">9.5.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#python-error-while-loading-shared-libraries-libpython2-7-so-1-0"><span class="nav-number">9.6.</span> <span class="nav-text">python: error while loading shared libraries: libpython2.7.so.1.0</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-16"><span class="nav-number">9.6.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-19"><span class="nav-number">9.6.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ImportError-No-module-named-pysqlite2"><span class="nav-number">9.7.</span> <span class="nav-text">ImportError: No module named pysqlite2</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-20"><span class="nav-number">9.7.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pip-is-configured-with-locations-that-require-TLS-SSL-however-the-ssl-module-in-Python-is-not-available"><span class="nav-number">9.8.</span> <span class="nav-text">pip is configured with locations that require TLS&#x2F;SSL, however the ssl module in Python is not available.</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-21"><span class="nav-number">9.8.1.</span> <span class="nav-text">解决</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%B8%80"><span class="nav-number">9.8.1.1.</span> <span class="nav-text">方法一</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%B9%E6%B3%95%E4%BA%8C"><span class="nav-number">9.8.1.2.</span> <span class="nav-text">方法二</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Error-while-processing-cluster-%E2%80%98druid-cluster%E2%80%99-sqlite3-Operational-Error-database-is-locked"><span class="nav-number">9.9.</span> <span class="nav-text">Error while processing cluster ‘druid cluster’ (sqlite3. Operational Error) database is locked</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-17"><span class="nav-number">9.9.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%9F%E5%9B%A0"><span class="nav-number">9.9.2.</span> <span class="nav-text">原因</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-22"><span class="nav-number">9.9.3.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#An-unknown-error-occurred-Status-0-Maybe-the-request-timed-out"><span class="nav-number">9.10.</span> <span class="nav-text">An unknown error occurred. (Status: 0) Maybe the request timed out?</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-18"><span class="nav-number">9.10.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-23"><span class="nav-number">9.10.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ImportError-No-module-named-pymysql"><span class="nav-number">9.11.</span> <span class="nav-text">ImportError: No module named pymysql</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-24"><span class="nav-number">9.11.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#uHost-druid01-is-not-allowed-to-connect-to-this-MySQL-server"><span class="nav-number">9.12.</span> <span class="nav-text">uHost druid01 is not allowed to connect to this MySQL server</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-19"><span class="nav-number">9.12.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-25"><span class="nav-number">9.12.2.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Permission-for-Druid"><span class="nav-number">9.13.</span> <span class="nav-text">Permission for Druid</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-26"><span class="nav-number">9.13.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Update-Druid-Cluster%E2%80%99s-Name"><span class="nav-number">9.14.</span> <span class="nav-text">Update Druid Cluster’s Name</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-27"><span class="nav-number">9.14.1.</span> <span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#An-unexpected-error-occurred-%E2%80%9Chttps-registry-yarnpkg-com-convert-source-map-ETIMEDOUT%E2%80%9D"><span class="nav-number">9.15.</span> <span class="nav-text">An unexpected error occurred: “https:&#x2F;&#x2F;registry.yarnpkg.com&#x2F;convert-source-map: ETIMEDOUT”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0-20"><span class="nav-number">9.15.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3-28"><span class="nav-number">9.15.2.</span> <span class="nav-text">解决</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BE%E5%8C%BA%E8%B7%9F%E8%BF%9B"><span class="nav-number">10.</span> <span class="nav-text">社区跟进</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B5%84%E6%96%99"><span class="nav-number">11.</span> <span class="nav-text">资料</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Doc"><span class="nav-number">11.1.</span> <span class="nav-text">Doc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Book"><span class="nav-number">11.2.</span> <span class="nav-text">Book</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Source"><span class="nav-number">11.3.</span> <span class="nav-text">Source</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AC%A2%E8%BF%8E%E5%8A%A0%E5%85%A5%E6%88%91%E4%BB%AC%E7%9A%84%E6%8A%80%E6%9C%AF%E7%BE%A4%EF%BC%8C%E4%B8%80%E8%B5%B7%E4%BA%A4%E6%B5%81%E5%AD%A6%E4%B9%A0"><span class="nav-number">12.</span> <span class="nav-text">欢迎加入我们的技术群，一起交流学习</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Benedict Jin" src="/yuzhouwan_logo_128x128.ico">
  <p class="site-author-name" itemprop="name">Benedict Jin</p>
  <div class="site-description" itemprop="description">Benedict Jin's Blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">55</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">161</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/asdf2014" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;asdf2014" rel="external nofollow noopener noreferrer" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:asdf2014@apache.org" title="E-Mail → mailto:asdf2014@apache.org" rel="external nofollow noopener noreferrer" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" class="cc-opacity" rel="external nofollow noopener noreferrer" target="_blank"><img src="/images/cc-by-nc-nd.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="external nofollow noopener noreferrer" target="_blank">苏 ICP 备 17032505号 </a>
  </div>

<div class="copyright">
  
  &copy; 2014 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yuzhouwan.com</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">1.4m</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">21:16</span>
</div>

        
<meta name="referrer" content="always">
<div class="busuanzi-count">
  <script async src="/lib/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/gh/fancyapps/fancybox@3/dist/jquery.fancybox.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/lozad@1/dist/lozad.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




<script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.5/lib/darkmode-js.min.js"></script>
<script>
var options = {
  bottom: '32px', // default: '32px'
  right: '32px', // default: '32px'
  left: 'unset', // default: 'unset'
  time: '0.5s', // default: '0.3s'
  mixColor: '#fff', // default: '#fff'
  backgroundColor: '#fff',  // default: '#fff'
  buttonColorDark: '#100f2c',  // default: '#100f2c'
  buttonColorLight: '#fff', // default: '#fff'
  saveInCookies: true, // default: true,
  label: '🌓', // default: ''
  autoMatchOsTheme: false // default: true
}
const darkmode = new Darkmode(options);
darkmode.showWidget();
</script>
<style>
button.darkmode-toggle {
  z-index: 9999;
}
img, .darkmode-ignore {
  isolation: isolate;
  display: block;
}
</style>

  




  
<script src="/js/local-search.js"></script>











<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme    : 'forest',
      logLevel : 3,
      flowchart: { curve     : 'linear' },
      gantt    : { axisFormat: '%m/%d/%Y' },
      sequence : { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  

  

<script>
  var disqus_config = function() {
    this.page.url = "https://yuzhouwan.com/posts/743/";
    this.page.identifier = "posts/743/";
    this.page.title = "Apache Superset 二次开发";
    };
  NexT.utils.loadComments(document.querySelector('#disqus_thread'), () => {
    if (window.DISQUS) {
      DISQUS.reset({
        reload: true,
        config: disqus_config
      });
    } else {
      var d = document, s = d.createElement('script');
      s.src = 'https://yuzhouwan.disqus.com/embed.js';
      s.setAttribute('data-timestamp', '' + +new Date());
      (d.head || d.body).appendChild(s);
    }
  });
</script>

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'e5da61069b94deb8ef3a',
      clientSecret: 'c60ad4e430be258b705027a036eeee3d71cb934b',
      repo        : 'gitment',
      owner       : 'asdf2014',
      admin       : ['asdf2014'],
      id          : '0efcf9a6affea5637f7b400a79cb7346',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : true,
      appId      : 'BU4bnWsdAliFfk3fz7iMcFUU-gzGzoHsz',
      appKey     : '1xVLNFSy1qGCda3wt4GiGzHG',
      placeholder: "上述信息都不是必填的，可以直接提交评论",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : false,
      serverURLs : ''
    });
  }, window.Valine);
});
</script><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
